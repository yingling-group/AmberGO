<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>Building AMBER Compatible Graphene Oxide Tutorial</title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

/* Override strong tags inside headings to maintain consistent weight */
h1 strong,
h2 strong,
h3 strong {
	font-weight: 600;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 10px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.collection-content td {
	white-space: pre-wrap;
	word-break: break-word;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	padding-inline-start: 0;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.page-description {
	margin-bottom: 2em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
	empty-cells: show;
}
.simple-table td {
	height: 29px;
	min-width: 120px;
}

.simple-table th {
	height: 29px;
	min-width: 120px;
}

.simple-table-header-color {
	background: rgb(247, 246, 243);
	color: black;
}
.simple-table-header {
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-flex;
	align-items: center;
	justify-content: center;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.callout img.notion-static-icon {
	width: 1em;
	height: 1em;
}

.callout p {
	margin: 0;
}

.callout h1,
.callout h2,
.callout h3 {
	margin: 0 0 0.6rem;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

blockquote.quote-large {
	font-size: 1.25em;
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(44, 44, 43, 1);
}
.highlight-gray {
	color: rgba(125, 122, 117, 1);
	fill: rgba(125, 122, 117, 1);
}
.highlight-brown {
	color: rgba(159, 118, 90, 1);
	fill: rgba(159, 118, 90, 1);
}
.highlight-orange {
	color: rgba(210, 123, 45, 1);
	fill: rgba(210, 123, 45, 1);
}
.highlight-yellow {
	color: rgba(203, 148, 52, 1);
	fill: rgba(203, 148, 52, 1);
}
.highlight-teal {
	color: rgba(80, 148, 110, 1);
	fill: rgba(80, 148, 110, 1);
}
.highlight-blue {
	color: rgba(56, 125, 201, 1);
	fill: rgba(56, 125, 201, 1);
}
.highlight-purple {
	color: rgba(154, 107, 180, 1);
	fill: rgba(154, 107, 180, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.highlight-red {
	color: rgba(207, 81, 72, 1);
	fill: rgba(207, 81, 72, 1);
}
.highlight-default_background {
	color: rgba(44, 44, 43, 1);
}
.highlight-gray_background {
	background: rgba(42, 28, 0, 0.07);
}
.highlight-brown_background {
	background: rgba(139, 46, 0, 0.086);
}
.highlight-orange_background {
	background: rgba(224, 101, 1, 0.129);
}
.highlight-yellow_background {
	background: rgba(211, 168, 0, 0.137);
}
.highlight-teal_background {
	background: rgba(0, 100, 45, 0.09);
}
.highlight-blue_background {
	background: rgba(0, 124, 215, 0.094);
}
.highlight-purple_background {
	background: rgba(102, 0, 178, 0.078);
}
.highlight-pink_background {
	background: rgba(197, 0, 93, 0.086);
}
.highlight-red_background {
	background: rgba(223, 22, 0, 0.094);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(125, 122, 117, 1);
	fill: rgba(125, 122, 117, 1);
}
.block-color-brown {
	color: rgba(159, 118, 90, 1);
	fill: rgba(159, 118, 90, 1);
}
.block-color-orange {
	color: rgba(210, 123, 45, 1);
	fill: rgba(210, 123, 45, 1);
}
.block-color-yellow {
	color: rgba(203, 148, 52, 1);
	fill: rgba(203, 148, 52, 1);
}
.block-color-teal {
	color: rgba(80, 148, 110, 1);
	fill: rgba(80, 148, 110, 1);
}
.block-color-blue {
	color: rgba(56, 125, 201, 1);
	fill: rgba(56, 125, 201, 1);
}
.block-color-purple {
	color: rgba(154, 107, 180, 1);
	fill: rgba(154, 107, 180, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.block-color-red {
	color: rgba(207, 81, 72, 1);
	fill: rgba(207, 81, 72, 1);
}
.block-color-default_background {
	color: inherit;
	fill: inherit;
}
.block-color-gray_background {
	background: rgba(240, 239, 237, 1);
}
.block-color-brown_background {
	background: rgba(245, 237, 233, 1);
}
.block-color-orange_background {
	background: rgba(251, 235, 222, 1);
}
.block-color-yellow_background {
	background: rgba(249, 243, 220, 1);
}
.block-color-teal_background {
	background: rgba(232, 241, 236, 1);
}
.block-color-blue_background {
	background: rgba(229, 242, 252, 1);
}
.block-color-purple_background {
	background: rgba(243, 235, 249, 1);
}
.block-color-pink_background {
	background: rgba(250, 233, 241, 1);
}
.block-color-red_background {
	background: rgba(252, 233, 231, 1);
}
.select-value-color-default { background-color: rgba(42, 28, 0, 0.07); }
.select-value-color-gray { background-color: rgba(28, 19, 1, 0.11); }
.select-value-color-brown { background-color: rgba(127, 51, 0, 0.156); }
.select-value-color-orange { background-color: rgba(196, 88, 0, 0.203); }
.select-value-color-yellow { background-color: rgba(209, 156, 0, 0.282); }
.select-value-color-green { background-color: rgba(0, 96, 38, 0.156); }
.select-value-color-blue { background-color: rgba(0, 118, 217, 0.203); }
.select-value-color-purple { background-color: rgba(92, 0, 163, 0.141); }
.select-value-color-pink { background-color: rgba(183, 0, 78, 0.152); }
.select-value-color-red { background-color: rgba(206, 24, 0, 0.164); }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="2965d369-2a6a-801b-a550-fd75b5c3c685" class="page sans"><header><img class="page-cover-image" src="honeycomb_graphene_realistic.png" style="object-position:center 61.38%"/><div class="page-header-icon page-header-icon-with-cover"><span class="icon">üêù</span></div><h1 class="page-title" dir="auto">Building AMBER Compatible Graphene Oxide Tutorial</h1><p class="page-description" dir="auto"></p></header><div class="page-body"><div style="display:contents" dir="auto"><hr id="2965d369-2a6a-8060-810e-e8a3b89f1f7b"/></div><div style="display:contents" dir="ltr"><figure id="29d5d369-2a6a-8024-8ff3-ea1281508d02" class="image"><a href="FlowchartProtocol_(4).png"><img style="width:314.8000183105469px" src="FlowchartProtocol_(4).png"/></a><figcaption><strong>Main Figure:</strong> This tutorial is the detailed explanation of this protocol with all necessary documents provided.</figcaption></figure></div><div style="display:contents" dir="auto"><p id="29d5d369-2a6a-80a7-bc77-c3fa863aecae" class="">
</p></div><div style="display:contents" dir="auto"><details open=""><summary style="font-weight:600;font-size:1.5em;line-height:1.3;margin:0">Step 1: Install HierGO</summary><div class="indented"><div style="display:contents" dir="auto"><ul id="2965d369-2a6a-80f8-b0b4-dbf5a12adedd" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked"><mark class="highlight-purple_background"><strong>Read the main HierGo paper for understanding background (geometry, tiling and defects) in more detail</strong></mark></span><div class="indented"><div style="display:contents" dir="ltr"><figure id="2965d369-2a6a-80a9-9afa-cca6c9818742"><a href="https://iopscience.iop.org/article/10.1088/2053-1583/acb0e1#tdmacb0e1s6" class="bookmark source"><div class="bookmark-info"><div class="bookmark-text"><div class="bookmark-title">Simulation-ready graphene oxide structures with hierarchical complexity: a modular tiling strategy - IOPscience</div><div class="bookmark-description">Simulation-ready graphene oxide structures with hierarchical complexity: a modular tiling strategy, Garcia, Natalya A, Awuah, Joel B, Zhao, Chaoyue, Vukoviƒá, Filip, Walsh, Tiffany R</div></div><div class="bookmark-href"><img src="https://iopscience.iop.org/favicon.ico" class="icon bookmark-icon"/>https://iopscience.iop.org/article/10.1088/2053-1583/acb0e1#tdmacb0e1s6</div></div></a></figure></div></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2965d369-2a6a-8016-9c35-fa0acacffbed" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked"><mark class="highlight-default"><mark class="highlight-purple_background">Get</mark></mark><mark class="highlight-default"><mark class="highlight-purple_background"><strong> the source code from GitHub. Once you do you will see </strong></mark></mark></span><div class="indented"><div style="display:contents" dir="auto"><ul id="2965d369-2a6a-80ff-b480-dcc7a0d562d4" class="bulleted-list"><li style="list-style-type:disc"><code>Scripts/</code> ‚Äì generators and utilities (e.g., <mark class="highlight-blue"><mark class="highlight-blue_background"><strong>create-tile.py</strong></mark></mark>)</li></ul></div><div style="display:contents" dir="auto"><ul id="2965d369-2a6a-801f-abe1-cb34eef88d58" class="bulleted-list"><li style="list-style-type:disc"><code>HoleLibrary/</code> ‚Äì predefined vacancy shapes/sizes</li></ul></div><div style="display:contents" dir="ltr"><figure id="2965d369-2a6a-809c-a289-fd13cff64642"><div class="source">https://github.com/IFM-molecular-simulation-group/HierGO</div></figure></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2965d369-2a6a-80d7-ab31-fe84539e1b9b" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all">git clone https://github.com/IFM-molecular-simulation-group/HierGO.git
cd HierGO</code></pre></div></div></li></ul></div></div></details></div><div style="display:contents" dir="auto"><details open=""><summary style="font-weight:600;font-size:1.5em;line-height:1.3;margin:0">Step 2: Build Graphene Tile as Template</summary><div class="indented"><div style="display:contents" dir="auto"><ul id="2965d369-2a6a-80f2-a80c-d42fe2174e7d" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked"><mark class="highlight-purple_background"><strong>Decide your target size (nm or √Ö) and map to factors</strong></mark></span><div class="indented"><div style="display:contents" dir="auto"><p id="2965d369-2a6a-8072-a00a-dbcaa6498bcb" class="">HierGO sets sheet dimensions by <strong>integer repeats</strong> of graphene‚Äôs 2D unit cell:</p></div><div style="display:contents" dir="auto"><ul id="2965d369-2a6a-8079-9702-fba0b20b5266" class="bulleted-list"><li style="list-style-type:disc"><style>@import url('https://cdn.jsdelivr.net/npm/katex@0.16.25/dist/katex-swap.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mi>x</mi><mo stretchy="false">(</mo><mover accent="true"><mi>A</mi><mo>Àö</mo></mover><mo stretchy="false">)</mo><mo>‚âà</mo><mn>2.5</mn><mo>√ó</mo><mi>x</mi><mi>f</mi><mi>a</mi><mi>c</mi><mi>t</mi><mi>o</mi><mi>r</mi></mrow><annotation encoding="application/x-tex">Lx(√Ö) ‚âà 2.5 √ó xfactor </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1968em;vertical-align:-0.25em;"></span><span class="mord mathnormal">Lx</span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9468em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">A</span></span><span style="top:-3.2523em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2361em;"><span class="mord">Àö</span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚âà</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">2.5</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">√ó</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">x</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal">a</span><span class="mord mathnormal">c</span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right:0.02778em;">or</span></span></span></span></span><span>Ôªø</span></span></li></ul></div><div style="display:contents" dir="auto"><ul id="2965d369-2a6a-80f0-bb19-ebfd7c775aaf" class="bulleted-list"><li style="list-style-type:disc"><style>@import url('https://cdn.jsdelivr.net/npm/katex@0.16.25/dist/katex-swap.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mi>y</mi><mo stretchy="false">(</mo><mover accent="true"><mi>A</mi><mo>Àö</mo></mover><mo stretchy="false">)</mo><mo>‚âà</mo><mn>2.5</mn><mo>√ó</mo><mi>y</mi><mi>f</mi><mi>a</mi><mi>c</mi><mi>t</mi><mi>o</mi><mi>r</mi></mrow><annotation encoding="application/x-tex">Ly(√Ö) ‚âà 2.5 √ó yfactor </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1968em;vertical-align:-0.25em;"></span><span class="mord mathnormal">L</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9468em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">A</span></span><span style="top:-3.2523em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2361em;"><span class="mord">Àö</span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">‚âà</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">2.5</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">√ó</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal">a</span><span class="mord mathnormal">c</span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right:0.02778em;">or</span></span></span></span></span><span>Ôªø</span></span></li></ul></div><div style="display:contents" dir="auto"><p id="2965d369-2a6a-80fc-950d-f1d4b671a1cb" class="">For example;</p></div><div style="display:contents" dir="auto"><ul id="2965d369-2a6a-8060-b509-c0b04d294644" class="bulleted-list"><li style="list-style-type:disc"><strong>Target:</strong> <style>@import url('https://cdn.jsdelivr.net/npm/katex@0.16.25/dist/katex-swap.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>¬†</mtext><mn>3</mn><mo>√ó</mo><mn>2</mn><mi>n</mi><msup><mi>m</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">~3 √ó 2 nm^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mspace nobreak">¬†</span><span class="mord">3</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">√ó</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord">2</span><span class="mord mathnormal">n</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span><span>Ôªø</span></span> = <style>@import url('https://cdn.jsdelivr.net/npm/katex@0.16.25/dist/katex-swap.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>¬†</mtext><mn>30</mn><mo>√ó</mo><mn>20</mn><msup><mover accent="true"><mi>A</mi><mo>Àö</mo></mover><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">~30 √ó 20 √Ö^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mspace nobreak">¬†</span><span class="mord">30</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">√ó</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.9468em;"></span><span class="mord">20</span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9468em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">A</span></span><span style="top:-3.2523em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2361em;"><span class="mord">Àö</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span><span>Ôªø</span></span> ‚Üí<strong>Pick: </strong><code>xfactor 13</code> and <code>yfactor 8</code></li></ul></div><div style="display:contents" dir="auto"><ul id="2965d369-2a6a-8055-a70c-e28d78d495ac" class="bulleted-list"><li style="list-style-type:disc"><strong>Target:</strong> <style>@import url('https://cdn.jsdelivr.net/npm/katex@0.16.25/dist/katex-swap.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>¬†</mtext><mn>20</mn><mo>√ó</mo><mn>20</mn><mi>n</mi><msup><mi>m</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">~20 √ó 20 nm^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mspace nobreak">¬†</span><span class="mord">20</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">√ó</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord">20</span><span class="mord mathnormal">n</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span><span>Ôªø</span></span> = <style>@import url('https://cdn.jsdelivr.net/npm/katex@0.16.25/dist/katex-swap.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>¬†</mtext><mn>200</mn><mo>√ó</mo><mn>200</mn><msup><mover accent="true"><mi>A</mi><mo>Àö</mo></mover><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">~200 √ó 200 √Ö^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mspace nobreak">¬†</span><span class="mord">200</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">√ó</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.9468em;"></span><span class="mord">200</span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9468em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">A</span></span><span style="top:-3.2523em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2361em;"><span class="mord">Àö</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span><span>Ôªø</span></span> ‚Üí<strong>Pick: </strong><code>xfactor 81</code> and <code>yfactor 81</code></li></ul></div></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2965d369-2a6a-808d-9bc1-e7d5bf5a2323" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked"><mark class="highlight-purple_background"><strong>Decide if you want to have pristine graphene or one with holes:</strong></mark> Use <code>percentvac=0</code> to keep it pristine.</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2965d369-2a6a-80bf-93ea-cfc9fb95e78c" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked"><mark class="highlight-purple_background"><strong>Choose periodic vs non-periodic: </strong></mark>his depends on whether a molecular simulation package supports <strong>periodic continuous bonds</strong> (i.e., molecules or structures whose bonds wrap across periodic boundaries so that the bond from one end of the box seamlessly connects to the opposite side) depends on a few things: how bonds are represented/connected, whether the software allows atoms of a molecule to be split across images, and how wrap/unwrap &amp; topology crossing is handled.</span><div class="indented"><div style="display:contents" dir="auto"><ul id="2965d369-2a6a-806b-a7e2-c781af384c3b" class="bulleted-list"><li style="list-style-type:disc"><strong>Periodic</strong>: Generally good option for MD simulations within GROMACS and LAMMPS based set ups</li></ul></div><div style="display:contents" dir="auto"><ul id="2965d369-2a6a-8021-ae93-e2dcaaed3f24" class="bulleted-list"><li style="list-style-type:disc"><strong>Non-periodic</strong> (<code>-non_periodic</code>): Convenient for cropping or building finite flakes. Use this option if using AMBER because it does not support periodic bonds (i.e., you cannot have a bond that crosses the periodic boundary and connects atoms on opposite sides of the simulation box).</li></ul></div></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2965d369-2a6a-8085-b9a0-fd0dca7e2191" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked"><mark class="highlight-purple_background"><strong>Copy this command in terminal</strong></mark></span><div class="indented"><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2965d369-2a6a-8098-be62-c03810f8d1c4" class="code code-wrap"><code class="language-Bash" style="white-space:pre-wrap;word-break:break-all">python3 Scripts/create-tile.py \
--xfactor 13 --yfactor 8 \
--percentvac 0 \
--non_periodic \
--outfile pristine_graphene_nonperiodic_30Ax20A.pdb</code></pre></div></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2965d369-2a6a-809f-bc70-edb1f3543fc6" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked"><mark class="highlight-purple_background"><strong>Check terminal output to confirm the dimensions of the generated structure</strong></mark></span><div class="indented"><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2965d369-2a6a-80d1-9dcd-f648d31cb37c" class="code code-wrap"><code class="language-Bash" style="white-space:pre-wrap;word-break:break-all">Size: 13 8
Vacancy Amount: 0.0
Distribution: mixed
Creating sheet of size 32.123000000000005 x 21.391
Creating Defects of Sizes: []
Trim Cycle 0
Trim Cycle 1
Actual vacancy amount of 0.7692307692307736 percent due to trimming hanging carbon atoms</code></pre></div></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2965d369-2a6a-80d0-8ceb-eb64e92f93eb" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked"><mark class="highlight-purple_background"><strong>Check the generated PDB file template:</strong></mark><mark class="highlight-default_background"><strong> </strong></mark><mark class="highlight-default_background">It can be seen that it makes the whole sheet as a single residue named UN</mark><mark class="highlight-default"><mark class="highlight-default_background">L. There are total of 258 atoms. T</mark></mark><mark class="highlight-default_background">he atom types are also not compatible so there is a few steps we need to do to fix all this. Also, visualize the structure for further inspection.</mark></span><div class="indented"><div style="display:contents" dir="auto"><ul id="2965d369-2a6a-809d-b2c9-ea92c25c9d6c" class="toggle"><li><details open=""><summary><strong>The PDB File</strong></summary><div style="display:contents" dir="ltr"><figure id="29d5d369-2a6a-8091-b128-f4043fb3f0c7"><div class="source"><a href="pristine_graphene_nonperiodic_30Ax20A.pdb">pristine_graphene_nonperiodic_30Ax20A.pdb</a></div></figure></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2965d369-2a6a-804a-8864-d9134ebef8da" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all">AUTHOR    GENERATED BY NG TILE DECORATION
CRYST1   52.123   41.391   40.000  90.00  90.00  90.00 P1          1
ATOM      0  C   UNL     1       1.841   1.775   0.000  1.00  0.00           C
ATOM      1  C   UNL     1       0.605   2.484   0.000  1.00  0.00           C
ATOM      2  C   UNL     1       0.605   3.908   0.000  1.00  0.00           C
ATOM      3  C   UNL     1       1.839   4.620   0.000  1.00  0.00           C
...
ATOM    255  C   UNL     1      31.493  18.867   0.000  1.00  0.00           C
ATOM    256  C   UNL     1      30.257  19.576   0.000  1.00  0.00           C
ATOM    257  C   UNL     1      30.257  21.000   0.000  1.00  0.00           C
</code></pre></div></details></li></ul></div><div style="display:contents" dir="ltr"><figure id="2965d369-2a6a-80d5-9f1d-d98268c92312" class="image"><a href="57c9b9b0-0a50-4cea-8d76-2d66f9c04d1c.png"><img style="width:476.72195121951216px" src="57c9b9b0-0a50-4cea-8d76-2d66f9c04d1c.png"/></a><figcaption><strong>Figure 1. </strong>Pristine graphene sheet. For better visualization of the size, the grid line is added.</figcaption></figure></div></div></li></ul></div></div></details></div><div style="display:contents" dir="auto"><details open=""><summary style="font-weight:600;font-size:1.5em;line-height:1.3;margin:0">Step 3: ‚ÄúDecorate‚Äù Graphene Tile</summary><div class="indented"><div style="display:contents" dir="auto"><details open=""><summary style="font-weight:600;font-size:1.25em;line-height:1.3;margin:0">Low Oxidation Case</summary><div class="indented"><div style="display:contents" dir="auto"><ul id="2965d369-2a6a-809a-8b55-ca549860a927" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked"><mark class="highlight-purple_background"><strong>Copy this example command in terminal:</strong></mark><mark class="highlight-default_background"><strong> </strong></mark>Decide the oxidation level (<code>--percento</code>) and the hydroxyl:epoxy ratio (<code>--fresh</code> or <code>--aged</code>).</span><div class="indented"><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2965d369-2a6a-802b-b105-e783b63c7eb9" class="code code-wrap"><code class="language-Bash" style="white-space:pre-wrap;word-break:break-all">python3 Scripts/decorate-tile.py \
--infile pristine_graphene_nonperiodic_30Ax20A.pdb \
--percento 20 \
--fresh 2:1 \
--outfile GO20_nonperiodic_30Ax20A.pdb</code></pre></div></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2965d369-2a6a-80f7-8258-e5dfab8ee42b" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked"><mark class="highlight-purple_background"><strong>Check terminal output:</strong></mark> Here, one can confirm the number of oxygen atoms added and which group is added in detail. For oxidation levels ‚â• 40%, the reported statistics may deviate from the actual oxygen coverage and ratio.</span><div class="indented"><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2965d369-2a6a-80c1-9414-f6c2b26ce7a9" class="code code-wrap"><code class="language-Bash" style="white-space:pre-wrap;word-break:break-all">Input parameters:
    Reading file pristine_graphene_nonperiodic_30Ax20A.pdb
    20.0% oxygen
    [Epoxy,Hydroxyl] = 2:1
Adding 51 oxygen atoms:
       O_hydroxyl:   10
     O_dihydroxyl:   24
          O_epoxy:   17</code></pre></div></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2965d369-2a6a-80d8-aa4b-df2b7e18de53" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked"><mark class="highlight-purple_background"><strong>Check the new generated PDB file:</strong></mark><mark class="highlight-default_background"><strong> </strong></mark><mark class="highlight-default">There are total of 374 atoms with the addition of H and O atoms. </mark><mark class="highlight-default_background">Again, the atom types are also not compatible, and it does not trim the H shown in green properly. There are obvious mistakes in the structure.</mark></span><div class="indented"><div style="display:contents" dir="auto"><ul id="2965d369-2a6a-802d-a9f1-f9cdf051b500" class="toggle"><li><details open=""><summary><strong>The PDB File</strong></summary><div style="display:contents" dir="ltr"><figure id="2965d369-2a6a-8093-b094-cf0cba066681"><div class="source"><a href="GO20_nonperiodic_30Ax20A.pdb">GO20_nonperiodic_30Ax20A.pdb</a></div></figure></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2965d369-2a6a-802c-acba-d1e9ee1b8434" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all">AUTHOR    GENERATED BY NG TILE DECORATION
CRYST1   52.123   41.391   40.000  90.00  90.00  90.00 P1          1
ATOM      0  C   UNL     1       1.841   1.775   0.000  1.00  0.00           C
ATOM      1  C   UNL     1       0.605   2.484   0.000  1.00  0.00           C
ATOM      2  C   UNL     1       0.605   3.908   0.000  1.00  0.00           C
ATOM      3  C   UNL     1       1.839   4.620   0.000  1.00  0.00           C
...
ATOM    372  H   UNL     1      29.018  22.712   0.000  1.00  0.00           H
ATOM    373  H   UNL     1      32.358  19.369   0.000  1.00  0.00           H
ATOM    374  H   UNL     1      31.124  21.499   0.000  1.00  0.00           H</code></pre></div></details></li></ul></div></div></li></ul></div><div style="display:contents" dir="ltr"><figure id="2965d369-2a6a-80f7-8c2a-e14d1462ac47" class="image"><a href="2ec384f1-9985-4f41-b0c9-48c79acc621d.png"><img style="width:710px" src="2ec384f1-9985-4f41-b0c9-48c79acc621d.png"/></a><figcaption><strong>Figure 2. </strong>20% modified graphene oxide. gray shows Carbon, red shows Oxygen and green shows the Hydrogens added after the decorate command.</figcaption></figure></div></div></details></div><div style="display:contents" dir="auto"><details open=""><summary style="font-weight:600;font-size:1.25em;line-height:1.3;margin:0">High Oxidation Case</summary><div class="indented"><div style="display:contents" dir="auto"><ul id="2995d369-2a6a-804a-9ca9-da6743dde2dd" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked"><mark class="highlight-purple_background"><strong>Set up the command:</strong></mark><mark class="highlight-default_background"><strong> </strong></mark>Decide the oxidation level (<code>--percento</code>) and the epoxy:hydroxyl ratio (<code>--fresh</code> or <code>--aged</code>).</span><div class="indented"><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2995d369-2a6a-803a-b641-f1b0bcbfb66e" class="code code-wrap"><code class="language-Bash" style="white-space:pre-wrap;word-break:break-all">python3 Scripts/decorate-tile.py \
--infile pristine_graphene_nonperiodic_30Ax20A.pdb \
--percento 60 \
--fresh 2:1 \
--outfile GO60_nonperiodic_30Ax20A.pdb</code></pre></div></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2995d369-2a6a-8022-b994-ffffc44f0367" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked"><mark class="highlight-purple_background"><strong>Check terminal output:</strong></mark>  At this high oxidation level, the original script fails to generate a valid structure. The output confirms that 60% oxidation was not successfully achieved.</span><div class="indented"><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2995d369-2a6a-80ef-a857-ed7865631bbe" class="code code-wrap"><code class="language-Bash" style="white-space:pre-wrap;word-break:break-all">Input parameters:
    Reading file pristine_graphene_nonperiodic_30Ax20A.pdb
    60.0% oxygen
    [Epoxy,Hydroxyl] = 2:1
Adding 154 oxygen atoms:
       O_hydroxyl:   32
     O_dihydroxyl:   70
          O_epoxy:   51
Warning: overlapping atoms may occur (di-hydroxyl placement failure)
Traceback (most recent call last):
  File &quot;/home/.../HierGO-master/Scripts/decorate-tile.py&quot;, line 1799, in &lt;module&gt;
    main()
  File &quot;/home/.../HierGO-master/Scripts/decorate-tile.py&quot;, line 1783, in main
    coords,atomtypes = add_oxygen_hydrogen(coords,atomtypes,abc,PossibleDefectSites,OxygenNumAndType)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/home/.../HierGO-master/Scripts/decorate-tile.py&quot;, line 1547, in add_oxygen_hydrogen
    NewO,NewH,PossibleDefectSites,o_up,o_down = add_all_dihydroxyl(NewO,NewH,OxygenNumAndType,coords,abc,PossibleDefectSites,NNList,o_up,o_down)
                                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/home/.../HierGO-master/Scripts/decorate-tile.py&quot;, line 1129, in add_all_dihydroxyl
    PossibleDefectSites.remove(c2index)
ValueError: list.remove(x): x not in list</code></pre></div></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2995d369-2a6a-80f1-a8c5-ec3fc6162b6c" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked"><mark class="highlight-purple_background"><strong>Run the modified decoration script:</strong></mark><strong> </strong>The modified version bypasses the original error and forces successful completion.</span><div class="indented"><div style="display:contents" dir="auto"><ul id="29a5d369-2a6a-8071-9c28-cd037b2f8798" class="toggle"><li><details open=""><summary><strong>Script: </strong><mark class="highlight-blue"><mark class="highlight-blue_background"><strong>decorate-tile_modified.py</strong></mark></mark></summary><div style="display:contents" dir="ltr"><figure id="29a5d369-2a6a-802c-bca3-dc0a86466dba"><div class="source"><a href="decorate-tile_modified.py">decorate-tile_modified.py</a></div></figure></div></details></li></ul></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2995d369-2a6a-8013-8811-d2378a2efbdd" class="code code-wrap"><code class="language-Bash" style="white-space:pre-wrap;word-break:break-all">python3 Scripts/decorate-tile_modified.py \
--infile pristine_graphene_nonperiodic_30Ax20A.pdb \
--percento 60 \
--fresh 2:1 \
--outfile GO60_nonperiodic_30Ax20A.pdb</code></pre></div><div style="display:contents" dir="auto"><p id="2995d369-2a6a-8054-aae2-fb79a4c83c97" class="">The script now runs without errors; however, the generated output may contain inaccurate values for the added functional groups. Initially, the program reports the expected modification ratio, but at high oxidation levels the actual decoration fails. When too many hydroxyl groups are added, there are no longer enough adjacent carbon sites available for epoxy formation, which requires two neighboring carbons.</p></div><div style="display:contents" dir="auto"><blockquote id="29a5d369-2a6a-8076-8d51-ccad404e716f" class=""><strong>Note: </strong>The modified script overrides these warnings and continues by adding mainly hydroxyl groups to achieve the target oxidation level. Therefore, it is essential to validate the output structure in later stages to confirm the actual oxidation composition and to correct any structural inconsistencies.</blockquote></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2995d369-2a6a-80ef-a35f-d660930c9ef6" class="code code-wrap"><code class="language-Bash" style="white-space:pre-wrap;word-break:break-all">Input parameters:
    Reading file pristine_graphene_nonperiodic_30Ax20A.pdb
    60.0% oxygen
    [Epoxy,Hydroxyl] = 2:1
Adding 154 oxygen atoms:
       O_hydroxyl:   109
     O_dihydroxyl:   30
          O_epoxy:   15</code></pre></div></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2995d369-2a6a-8020-a0d2-d472c37f8116" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked"><mark class="highlight-purple_background"><strong>Inspect the generated PDB file:</strong></mark><mark class="highlight-default_background"><strong> </strong></mark><mark class="highlight-default_background">The decorated structure contains a total of 575 atoms, including newly added H and O atoms. However, the atom types remain inconsistent, and some hydrogen atoms (shown in green) are not trimmed properly, resulting in structural errors that must be corrected later.</mark></span><div class="indented"><div style="display:contents" dir="auto"><ul id="2995d369-2a6a-80e2-89f8-d6d00e0b4f81" class="toggle"><li><details open=""><summary><strong>The PDB File</strong></summary><div style="display:contents" dir="ltr"><figure id="2995d369-2a6a-8070-aff3-c7ebddaa091d"><div class="source"><a href="GO60_nonperiodic_30Ax20A.pdb">GO60_nonperiodic_30Ax20A.pdb</a></div></figure></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2995d369-2a6a-80d1-b863-e6d80acb52b3" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all">AUTHOR    GENERATED BY NG TILE DECORATION
CRYST1   52.123   41.391   40.000  90.00  90.00  90.00 P1          1
ATOM      0  C   UNL     1       1.841   1.775   0.000  1.00  0.00           C
ATOM      1  C   UNL     1       0.605   2.484   0.000  1.00  0.00           C
ATOM      2  C   UNL     1       0.605   3.908   0.000  1.00  0.00           C
ATOM      3  C   UNL     1       1.839   4.620   0.000  1.00  0.00           C

...
ATOM    572  H   UNL     1      19.134  22.712   0.000  1.00  0.00           H
ATOM    573  H   UNL     1      21.605  22.712   0.000  1.00  0.00           H
ATOM    574  H   UNL     1      32.358  19.369   0.000  1.00  0.00           H</code></pre></div></details></li></ul></div><div style="display:contents" dir="ltr"><figure id="2995d369-2a6a-80fb-a2c0-f41a769bc2be" class="image"><a href="799f8af5-a85b-4de4-9276-d031500e25ed.png"><img style="width:710px" src="799f8af5-a85b-4de4-9276-d031500e25ed.png"/></a><figcaption><strong>Figure 3. </strong>60% modified graphene oxide (top-down view). gray shows Carbon, red shows Oxygen and green shows the Hydrogens added after the decorate command. Although only one side is visible, oxidation occurs on both surfaces of the sheet.</figcaption></figure></div></div></li></ul></div></div></details></div></div></details></div><div style="display:contents" dir="auto"><details open=""><summary style="font-weight:600;font-size:1.5em;line-height:1.3;margin:0">Step 4: Prepare Output for Parameterization (pdb ‚Üí mol2)</summary><div class="indented"><div style="display:contents" dir="auto"><ul id="2995d369-2a6a-8092-a5f1-f46a273c181b" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked"><mark class="highlight-purple_background"><strong>Rename the PDB output file:</strong></mark><strong> </strong> <mark class="highlight-teal"><mark class="highlight-teal_background">GO20_nonperiodic_30Ax20A.pdb</mark></mark><mark class="highlight-default_background"> to </mark><mark class="highlight-teal"><mark class="highlight-teal_background">1_GO20_nonperiodic_30Ax20A.pdb</mark></mark><mark class="highlight-default_background"> or</mark><mark class="highlight-teal"><mark class="highlight-teal_background"> GO60_nonperiodic_30Ax20A.pdb</mark></mark><mark class="highlight-default_background"> to </mark><mark class="highlight-teal"><mark class="highlight-teal_background">1_GO60_nonperiodic_30Ax20A.pdb</mark></mark><mark class="highlight-default_background"> . This is not essential step, but it is included here because there will be several steps that follows saving new file pattern, adding number in  the beginning of the filename will make it easier to know what was done in the protocol what file came next.</mark></span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2995d369-2a6a-8034-b4b1-f1cc1dec5e72" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked"><mark class="highlight-purple_background"><strong>Open the PDB file in Discovery Studio Visualizer (DS Visualizer): </strong></mark>Load the PDB output generated from HierGO (e.g.,<mark class="highlight-teal"><mark class="highlight-teal_background">1_GO20_nonperiodic_30Ax20A.pdb</mark></mark> or <mark class="highlight-teal"><mark class="highlight-teal_background">1_GO60_nonperiodic_30Ax20A.pdb</mark></mark></span><div class="indented"><div style="display:contents" dir="auto"><blockquote id="2995d369-2a6a-8031-a22e-d9e68d626e2b" class=""><strong>Note:¬†</strong>Discovery Studio Visualizer may freeze or appear unresponsive  if you have a very large sheet. Be patient, click¬†‚ÄúWait‚Äù¬†if prompted or allow the program to finish loading the full structure.</blockquote></div><div style="display:contents" dir="auto"><blockquote id="2995d369-2a6a-8077-be1e-e1fb9d6b0c9a" class=""><strong>Another Note:¬†</strong>You can use other software or methods to remove unwanted atoms. However, this tutorial demonstrates the process in DS visualizer because it provides a more user-friendly interface and has been verified to work reliably for this workflow.</blockquote></div><div style="display:contents" dir="ltr"><figure id="29a5d369-2a6a-80a5-841d-dda9584e831c" class="image"><a href="Screenshot_from_2025-10-28_12-37-17.png"><img style="width:1350.984375px" src="Screenshot_from_2025-10-28_12-37-17.png"/></a><figcaption><strong>Figure 4. </strong>Example screenshot loaded for the Discovery Studio Visualizer.</figcaption></figure></div></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2995d369-2a6a-8057-904a-ce7c016a21b3" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked"><mark class="highlight-purple_background"><strong>Remove hanging atoms, and the Hydrogen at the edges: </strong></mark>Delete any loose atoms or hanging carbons that remain after the decoration step. Use the¬†<strong>red ‚ÄúX‚Äù icon</strong>¬†on the top toolbar or press¬†<strong>Delete</strong>¬†on your keyboard. Avoid using¬†<strong>Cut</strong>¬†tools, as they can break bonds incorrectly.</span><div class="indented"><div style="display:contents" dir="ltr"><figure id="29a5d369-2a6a-803c-98fb-c9487fee0eda" class="image"><a href="Screenshot_from_2025-10-28_12-40-04.png"><img style="width:1350.984375px" src="Screenshot_from_2025-10-28_12-40-04.png"/></a><figcaption><strong>Figure 5: </strong>Example screenshot. Atoms to be removed shown in yellow.</figcaption></figure></div><div style="display:contents" dir="ltr"><figure id="29a5d369-2a6a-80e0-8a13-f5af050964cc" class="image"><a href="Screenshot_from_2025-10-28_12-40-37.png"><img style="width:1350.984375px" src="Screenshot_from_2025-10-28_12-40-37.png"/></a><figcaption><strong>Figure 6: </strong>Example screenshot, edge hydrogen and hanging atoms had been removed.</figcaption></figure></div></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2995d369-2a6a-8028-9367-c6c1b4a82625" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked"><mark class="highlight-purple_background"><strong>Save the cleaned structure:</strong></mark><strong> </strong>Export the updated coordinates as a new¬†<mark class="highlight-teal"><mark class="highlight-teal_background">.pdb</mark></mark>¬†file from DS Visualizer. After cleaning the HierGO output in DS Visualizer, several key differences appear in the exported <mark class="highlight-teal"><mark class="highlight-teal_background">.pdb</mark></mark> file, beyond the removal of loose or hanging atoms.</span><div class="indented"><div style="display:contents" dir="auto"><blockquote id="29a5d369-2a6a-80de-94f0-fcd6a85854bd" class=""><strong>Note: </strong>The HierGO PDB is a raw coordinate dump. It contains atomic positions but lacks bonding or standard formatting cues used in molecular dynamics packages. The DSV-exported PDB adds missing topological structure (bonds and terminators), adopts HETATM notation, and ensures standardized formatting for downstream use. These changes make the DSV file better suited for conversion to MOL2 or parameterization in AMBER or GAFF, since tools like Antechamber rely on proper atom ordering and bond connectivity.</blockquote></div><div style="display:contents" dir="auto"><ul id="2995d369-2a6a-8043-b993-d659e4435af2" class="toggle"><li><details open=""><summary><strong>The PDB File</strong></summary><div style="display:contents" dir="ltr"><figure id="2995d369-2a6a-80c3-ae5a-cbd0548b6244"><div class="source"><a href="2_GO20_nonperiodic_30Ax20A_DSV.pdb">2_GO20_nonperiodic_30Ax20A_DSV.pdb</a></div></figure></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2995d369-2a6a-80ac-962c-f64e0e7aeabb" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all">REMARK   BIOVIA PDB file
REMARK   Created:  2025-10-28T12:43:02Z
CRYST1   52.123   41.391   40.000  90.00  90.00  90.00 P1         
HETATM    1  C   UNL     1       1.841   1.775   0.000  1.00  0.00           C  
HETATM    2  C   UNL     1       0.605   2.484   0.000  1.00  0.00           C  
HETATM    3  C   UNL     1       0.605   3.908   0.000  1.00  0.00           C  
...
CONECT  341  307
CONECT  342  308
CONECT  343  309
END</code></pre></div></details></li></ul></div></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2995d369-2a6a-80c2-9076-f6923c7c78e7" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked"><mark class="highlight-purple_background"><strong>Convert to MOL2 format using VMD:</strong></mark><strong> </strong>Open the <mark class="highlight-teal"><mark class="highlight-teal_background">.pdb</mark></mark>¬†from the previous step (e.g., <mark class="highlight-teal"><mark class="highlight-teal_background">2_GO20_nonperiodic_30Ax20A_DSV.pdb</mark></mark> file in¬†VMD. Go to¬†File ‚Üí Save Coordinates ‚Üí Write Structure¬†and select¬†MOL2¬†as the output format. Save as¬†<mark class="highlight-teal"><mark class="highlight-teal_background">3_GO20_nonperiodic_30Ax20A_DSV_VMD.mol2</mark></mark>.</span><div class="indented"><div style="display:contents" dir="auto"><ul id="2995d369-2a6a-80c4-95ac-f0dfcfd4a7e4" class="toggle"><li><details open=""><summary><strong>The MOL2 File</strong></summary><div style="display:contents" dir="ltr"><figure id="2995d369-2a6a-80c5-9b33-e7394ce3c86c"><div class="source"><a href="3_GO20_nonperiodic_30Ax20A_DSV_VMD.mol2">3_GO20_nonperiodic_30Ax20A_DSV_VMD.mol2</a></div></figure></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2995d369-2a6a-8076-a356-d901818e7261" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all">@&lt;TRIPOS&gt;MOLECULE
generated by VMD
  343  467    1    0    0
SMALL
NO_CHARGES
****
Energy = 0

@&lt;TRIPOS&gt;ATOM
      1  C          1.8410    1.7750    0.0000    C    1  UNL        0.000000
      2  C          0.6050    2.4840    0.0000    C    1  UNL        0.000000
      3  C          0.6050    3.9080    0.0000    C    1  UNL        0.000000

...
  464   306   340  1
  465   307   341  1
  466   308   342  1
  467   309   343  1

@&lt;TRIPOS&gt;SUBSTRUCTURE
1 ****        1 TEMP                        0 ****  **** 0 ROOT</code></pre></div></details></li></ul></div><div style="display:contents" dir="auto"><ul id="29a5d369-2a6a-8018-9640-d3168620210a" class="toggle"><li><details open=""><summary>Comparison of opening <mark class="highlight-teal"><mark class="highlight-teal_background">1_GO20_nonperiodic_30Ax20A.pdb</mark></mark> vs <mark class="highlight-teal"><mark class="highlight-teal_background">2_GO20_nonperiodic_30Ax20A_DSV.pdb</mark></mark> in VMD.</summary><div style="display:contents" dir="auto"><div id="29a5d369-2a6a-80a6-b1f2-ccf235dfe4cd" class="column-list"><div style="display:contents" dir="auto"><div id="29a5d369-2a6a-80df-a59c-f846473d8891" style="width:50%" class="column"><div style="display:contents" dir="auto"><p id="29a5d369-2a6a-8022-a667-de33b4d3a903" class=""><mark class="highlight-teal"><mark class="highlight-teal_background"><strong>1_GO20_nonperiodic_30Ax20A.pdb</strong></mark></mark></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="29a5d369-2a6a-80f1-91a8-ec1cb3cffaf4" class="code code-wrap"><code class="language-Bash" style="white-space:pre-wrap;word-break:break-all">...
Info) Using plugin pdb for structure file 1_GO20_nonperiodic_30Ax20A.pdb
Info) Determining bond structure from distance search ...
Info)    Atoms: 375
Info)    Bonds: 490
Info)    Residues: 10
Info)    Fragments: 10
...</code></pre></div><div style="display:contents" dir="auto"><p id="29a5d369-2a6a-80cd-b362-fcb89143f813" class="">The HierGO PDB does not contain <code>CONECT</code> records, so VMD must guess bonds based on interatomic distances. Because the sheet includes many close carbon atoms and dangling atoms near edges, VMD overestimates the number of fragments, splitting the sheet into 10 disconnected fragments. This fragmented topology makes it unreliable for parameterization or exporting to <mark class="highlight-teal"><mark class="highlight-teal_background">.mol2</mark></mark>.</p></div><div style="display:contents" dir="auto"><p id="29a5d369-2a6a-80ae-8810-e2d1a8731dab" class="">
</p></div></div></div><div style="display:contents" dir="auto"><div id="29a5d369-2a6a-808d-af59-ffbe28f730ee" style="width:50%" class="column"><div style="display:contents" dir="auto"><p id="29a5d369-2a6a-80d9-8b1f-ec4186f62af1" class=""><mark class="highlight-teal"><mark class="highlight-teal_background"><strong>2_GO20_nonperiodic_30Ax20A_DSV.pdb</strong></mark></mark></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="29a5d369-2a6a-80b8-ba99-c5375cf68934" class="code code-wrap"><code class="language-Bash" style="white-space:pre-wrap;word-break:break-all">...
Info) Using plugin pdb for structure file 2_GO20_nonperiodic_30Ax20A_DSV.pdb
Info) Determining bond structure from distance search ...
Info) Eliminating bonds duplicated from existing structure...
Info)    Atoms: 343
Info)    Bonds: 467
Info)    Residues: 1
Info)    Fragments: 1
...</code></pre></div><div style="display:contents" dir="auto"><p id="29a5d369-2a6a-80f6-b13e-ef14a672ab6f" class="">The DS Visualizer cleaned PDB includes explicit <code>CONECT</code> records, so VMD reads the true bond topology rather than guessing it. The structure is now treated as a single residue (UNL) and one continuous fragment, which is correct for a graphene sheet. The number of atoms is smaller because loose and hanging atoms were deleted in DSV. When saved as <mark class="highlight-teal"><mark class="highlight-teal_background">.mol2</mark></mark>, VMD reports the correct number of bonds (467), producing a clean and consistent MOL2 file suitable for AMBER compatible GAFF parameterization.</p></div></div></div></div></div></details></li></ul></div></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2995d369-2a6a-809d-ae61-d22a35ede045" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked"><mark class="highlight-purple_background"><strong>Assign atom types and residues in VMD:</strong></mark> Open the new <mark class="highlight-teal"><mark class="highlight-teal_background">.mol2</mark></mark> file (<mark class="highlight-teal"><mark class="highlight-teal_background">3_GO20_nonperiodic_30Ax20A_DSV_VMD.mol2</mark></mark>) in a fresh VMD session and run the Tcl script to reassign atom types and residues. You can do this by typing the <code>source</code> command in the Tk Console or by copying and pasting the entire script contents and pressing Enter.</span><div class="indented"><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="29a5d369-2a6a-800c-9edf-fe01f75c431f" class="code code-wrap"><code class="language-Bash" style="white-space:pre-wrap;word-break:break-all">source 1_GO_atom_info_assignment.tcl</code></pre></div><div style="display:contents" dir="auto"><ul id="29a5d369-2a6a-80ae-ae5b-eaa64614ab9c" class="toggle"><li><details open=""><summary><strong>Script:</strong><mark class="highlight-blue"><mark class="highlight-blue_background"><strong> 1_GO_atom_info_assignment.tcl</strong></mark></mark></summary><div style="display:contents" dir="ltr"><figure id="29a5d369-2a6a-80ce-9b4c-f24fa4c6b1be"><div class="source"><a href="1_GO_atom_info_assignment.tcl">1_GO_atom_info_assignment.tcl</a></div></figure></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2995d369-2a6a-80ab-9cdd-f0c674e209a4" class="code code-wrap"><code class="language-Bash" style="white-space:pre-wrap;word-break:break-all">source 1_GO_atom_info_assignment.tcl</code></pre></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="29a5d369-2a6a-806b-b5a1-f04434768f61" class="code code-wrap"><code class="language-Bash" style="white-space:pre-wrap;word-break:break-all"># ------------------------------------------------------------------------------
# Title: Graphene Oxide Atom Info Assignment Script (3 Residue Approach)
# ------------------------------------------------------------------------------
# Purpose:
#   This script processes a large graphene oxide (GO) sheet in VMD by assigning
#   atoms to three residues:
#       1) GRA - all unmodified carbons (and anything else not in OH or EPX)
#       2) OH  - all hydroxyl-modified carbons, oxygens, and hydrogens
#       3) EPX - all epoxy-modified carbons and oxygens
#
# Usage:
#   1) Load your GO structure in VMD.
#   2) Run this script in the VMD console or with: `vmd -dispdev text -e this_script.tcl`.
#
# Output:
#   &quot;GO_modified.mol2&quot; with three residues (GRA, OH, EPX).
#
# Author: Merve Fedai
# Date: 12/24/24
# ------------------------------------------------------------------------------
# Notes:
# - Atom types and partial charges come from gaff logic:
#     c3, ca, ho, oh, os
# - Adjust distance cutoffs/criteria if needed.
# - This script assumes:
#     - &quot;name C&quot; for carbons
#     - &quot;name O&quot; for oxygens
#     - &quot;name H&quot; for hydrogens
#     - &quot;resname UNL&quot; for the original graphene base (if any).
# ------------------------------------------------------------------------------

# ----------------------------------------------------------------
# STEP 0: RESET ALL RESIDS
# ----------------------------------------------------------------
# 1) Set all residue IDs to 0 so we start from a clean slate
set allAtoms [atomselect top &quot;all&quot;]
$allAtoms set resid 0
$allAtoms delete

# ----------------------------------------------------------------
# STEP 1: ASSIGN DEFAULT RESID=1, RESNAME=GRA
# ----------------------------------------------------------------
# Everything (including all carbons, oxygens, hydrogens) becomes resid=1, GRA initially.
set defaultAll [atomselect top &quot;all&quot;]
$defaultAll set resid 1
$defaultAll set resname GRA
$defaultAll delete

# Now set sp¬≤ carbons to &#x27;ca&#x27; as a baseline (unmodified GO).
# (We can override them later for epoxy/hydroxyl.)
set ca_carbons [atomselect top &quot;name C&quot;]
$ca_carbons set type ca
$ca_carbons delete

# ----------------------------------------------------------------
# STEP 2: ASSIGN HYDROXYL (OH) GROUPS TO RESID=2
# ----------------------------------------------------------------
# We&#x27;ll identify:
#   - Hydroxyl carbons: &quot;name C and within 2.0 of name O&quot;
#   - Hydroxyl oxygens: &quot;name O&quot; (but you might refine to &quot;within 2.0 of name C&quot; or similar)
#   - Hydroxyl hydrogens: &quot;name H&quot; (optionally within 2.0 or 1.5 of those oxygens)
#
# Then we override (resid=2, resname=OH) and set partial charges / types.

# 2A. Hydroxyl carbons
set hydroxyl_carbons [atomselect top &quot;name C and within 2.0 of name O&quot;]
$hydroxyl_carbons set resid 2
$hydroxyl_carbons set resname OH
$hydroxyl_carbons set type c3
$hydroxyl_carbons set charge 0.16
$hydroxyl_carbons delete

# 2B. Hydroxyl oxygens
set hydroxyl_oxygens [atomselect top &quot;name O&quot;]
$hydroxyl_oxygens set resid 2
$hydroxyl_oxygens set resname OH
$hydroxyl_oxygens set type oh
$hydroxyl_oxygens set charge -0.57
$hydroxyl_oxygens delete

# 2C. Hydroxyl hydrogens
set hydroxyl_hydrogens [atomselect top &quot;name H&quot;]
$hydroxyl_hydrogens set resid 2
$hydroxyl_hydrogens set resname OH
$hydroxyl_hydrogens set type ho
$hydroxyl_hydrogens set charge 0.41
$hydroxyl_hydrogens set name H1
$hydroxyl_hydrogens delete

# ----------------------------------------------------------------
# STEP 3: ASSIGN EPOXY (EPX) GROUPS TO RESID=3
# ----------------------------------------------------------------
# Identify epoxy carbons and oxygens (ringsize 3 from name C/O).
# Then override to resid=3, resname=EPX.

# 3A. Epoxy carbons
set epoxy_carbons [atomselect top &quot;ringsize 3 from name C&quot;]
$epoxy_carbons set resid 3
$epoxy_carbons set resname EPX
$epoxy_carbons set type c3
$epoxy_carbons set charge 0.16
$epoxy_carbons delete

# 3B. Epoxy oxygens
set epoxy_oxygens [atomselect top &quot;ringsize 3 from name O&quot;]
$epoxy_oxygens set resid 3
$epoxy_oxygens set resname EPX
$epoxy_oxygens set type os
$epoxy_oxygens set charge -0.32
$epoxy_oxygens delete

# ----------------------------------------------------------------
# STEP 4: RENAME OXYGENS TO O1
# ----------------------------------------------------------------
# Just for consistent naming in the output
set oxygens [atomselect top &quot;name O&quot;]
$oxygens set name O1
$oxygens delete

# ----------------------------------------------------------------
# STEP 5: CHECK FOR STRUCTURAL ARTIFACTS
# ----------------------------------------------------------------

# Note: Make further improvement to the script including;
# 1- Determine the resname of the defected carbon
# 2- Based on the resname determine which atoms to remove. For example, if the atom is EPX remove the hydroxyl based attached atoms.
# 3- Determine atoms&#x27; indeces that are causing the defect. And save the structure exluding these indeces.

# Check for c3 atoms meeting specific criteria and warn users if any are found
set epoxy_hydroxy [atomselect top &quot;type c3 and (within 2 of type os) and (within 2 of type oh)&quot;]
set double_hydroxy [atomselect top &quot;type c3 and (within 2 of type oh) and (within 2 of z \&quot;-1.700000.*\&quot;) and (within 2 of z 1.700000)&quot;]
set double_epoxy [atomselect top &quot;type c3 and (within 2 of type oh) and (within 2 of z 1.283000) and (within 2 of z \&quot;-1.283000.*\&quot;)&quot;]

if {[$epoxy_hydroxy num] &gt; 0} {
    set epoxy_hydroxy_ids [$epoxy_hydroxy list]
    puts &quot;WARNING: Structural artifact detected! C3 atom with epoxy and hydroxyl groups on the same carbon. Atom IDs: $epoxy_hydroxy_ids&quot;
}
if {[$double_hydroxy num] &gt; 0} {
    set double_hydroxy_ids [$double_hydroxy list]
    puts &quot;WARNING: Structural artifact detected! C3 atom with double hydroxyl addition on opposite sides of same carbon. Atom IDs: $double_hydroxy_ids&quot;
}
if {[$double_epoxy num] &gt; 0} {
    set double_epoxy_ids [$double_epoxy list]
    puts &quot;WARNING: Structural artifact detected! C3 atom with double epoxy addition on opposite sides of same carbon. Atom IDs: $double_epoxy_ids&quot;
}

if {([$epoxy_hydroxy num] == 0) &amp;&amp; ([$double_hydroxy num] == 0) &amp;&amp; ([$double_epoxy num] == 0)} {
    puts &quot;No structural artifacts detected. Your structure is clean.&quot;
}

$epoxy_hydroxy delete
$double_hydroxy delete
$double_epoxy delete

#~ # Specify the molecule ID (usually 0 if only one molecule is loaded)
#~ set mol 0

#~ # Specify the indices of atoms to exclude
#~ set excluded_indices {21393 25977}

#~ # Select all atoms except those in the excluded_indices
#~ set selection [atomselect $mol &quot;all not index [join $excluded_indices &quot; &quot;]&quot;]

#~ # Save the selected atoms to a new MOL2 file
#~ set outfile &quot;modified_structure.mol2&quot;
#~ $selection writemol2 $outfile

# ----------------------------------------------------------------
# STEP 6: SAVE THE FINAL MOL2 FILE
# ----------------------------------------------------------------
set all_final [atomselect top &quot;all&quot;]
$all_final writemol2 &quot;GO_modified.mol2&quot;
$all_final delete

puts &quot;Done! Your GO sheet now has three residues: GRA, OH, and EPX.&quot;
</code></pre></div></details></li></ul></div><div style="display:contents" dir="auto"><p id="29a5d369-2a6a-80ac-8f49-f66ec274c173" class="">This script automatically classifies all atoms into three residue groups: <strong>GRA</strong> (unmodified graphene carbons), <strong>OH</strong> (hydroxyl groups), and <strong>EPX</strong> (epoxy groups), and assigns <strong>GAFF-style atom types</strong> (<code>ca</code>, <code>c3</code>, <code>oh</code>, <code>ho</code>, <code>os</code>) with representative partial charges. It also checks for possible structural artifacts such as overlapping groups or carbons bonded to both epoxy and hydroxyl atoms. When executed correctly, the VMD console will display progress messages and finish with:</p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="29a5d369-2a6a-807b-8132-e29b7d97cbb3" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">No structural artifacts detected. Your structure is clean.
Done! Your GO sheet now has three residues: GRA, OH, and EPX.</code></pre></div><div style="display:contents" dir="ltr"><figure id="29a5d369-2a6a-80b5-a62f-d10938e3a2e2" class="image"><a href="Screenshot_from_2025-10-28_13-20-10.png"><img style="width:1350.984375px" src="Screenshot_from_2025-10-28_13-20-10.png"/></a><figcaption><strong>Figure 7. </strong>Example screenshot for the GO20 that is generated.</figcaption></figure></div><div style="display:contents" dir="auto"><p id="29a5d369-2a6a-8042-a75b-ec95ff111965" class="">If the output instead reports <strong>structural defects (</strong>for example, <em>‚ÄúWARNING: Structural artifact detected! ‚Ä¶‚Äù</em>), it will list the <strong>specific atom IDs</strong> where these issues occur. This means some artifacts were not fully removed during the earlier DS Visualizer cleaning step. In that case, reopen the structure in DS Visualizer, locate and delete those problematic atoms, save the corrected PDB, and repeat the conversion and assignment steps. When no warnings appear, verify that the final output file <mark class="highlight-teal"><mark class="highlight-teal_background">GO_modified.mol2</mark></mark> loads cleanly in VMD with the correct residue and atom assignments. </p></div><div style="display:contents" dir="auto"><blockquote id="29a5d369-2a6a-8010-88b9-c2d84a9a5ae6" class=""><strong>Note:</strong> For consistency with the tutorial workflow, rename the output file <mark class="highlight-teal"><mark class="highlight-teal_background">GO_modified.mol2</mark></mark> to <mark class="highlight-teal"><mark class="highlight-teal_background">4_GO_modified.mol2</mark></mark> before proceeding to the next step.</blockquote></div><div style="display:contents" dir="auto"><blockquote id="29a5d369-2a6a-80cc-90df-f201992cdfd8" class=""><strong>Side Note: Explanation for reason why we set atom types compatible for GAFF (not GAFF2) for </strong><mark class="highlight-blue"><mark class="highlight-blue_background"><strong>1_GO_atom_info_assignment.tcl</strong></mark></mark><mark class="highlight-default"><mark class="highlight-default_background"><strong>?</strong></mark></mark><div style="display:contents" dir="auto"><p id="29a5d369-2a6a-80df-9b46-e145d864da2f" class="">We format atom types for GAFF rather than GAFF2 to keep the parameter space small and fully covered by an existing, validated FRCMOD file from another Yingling group alumnus, Dr. Hoshin Kim. In practice, GAFF2 dramatically increases the number of distinct atom types and consequently generates a flood of new bond, angle, dihedral, and improper terms that Antechamber would require for a large GO patch. Each run produced fresh, unique terms needing one-off parameterization, forcing us to slice the sheet into smaller patches (since Antechamber cannot handle very large systems), fit parameters iteratively, and manually merge an ever-expanding FRCMOD. This made the process impractical for large-scale GO systems.</p></div><div style="display:contents" dir="auto"><p id="29a5d369-2a6a-80f6-ad12-c954fc3ab725" class="">By mapping GO to a minimal, GAFF-compatible set, <code>ca</code> (aromatic sp¬≤ C) for all unmodified carbons and <code>c3</code> (sp¬≥ C) for hydroxyl/epoxy carbons, plus <code>oh</code>/<code>ho</code>/<code>os</code> for O/H atoms; we can directly reuse the alumni FRCMOD, avoid the endless parameter chase, and maintain a reproducible workflow that scales efficiently.</p></div><div style="display:contents" dir="auto"><p id="29a5d369-2a6a-801c-86e5-c91a24c6b41a" class="">While atom types such as <code>c1</code> and <code>c2</code> would be more chemically appropriate for edge carbons or regions with partial re-hybridization, assigning them as <code>ca</code> represents only a minor compromise for very large GO sheets. This simplification sacrifices some chemical granularity (for example, subtle differences among modified sp¬≥ carbons are not distinguished), but it delivers a stable, parameter-complete model that runs immediately in AMBER, while preserving the essential physics between aromatic and sp¬≥-modified regions. If higher specificity is needed later, GAFF2-level types can be selectively reintroduced for small, representative fragments, and the newly validated parameters can then be ported back into the main FRCMOD.</p></div><div style="display:contents" dir="auto"><div id="29a5d369-2a6a-8084-b6c1-d95e4fadba17" class="column-list"><div style="display:contents" dir="auto"><div id="29a5d369-2a6a-801c-8071-df722fa68b72" style="width:50%" class="column"><div style="display:contents" dir="auto"><h3 id="29a5d369-2a6a-80ba-b545-dfca3da3686c" class="">GAFF (Current approach)</h3></div><div style="display:contents" dir="auto"><ol type="1" id="29a5d369-2a6a-801d-b46e-da0812a8a866" class="numbered-list" start="1"><li><code>c1</code>: sp carbon (not used)</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="29a5d369-2a6a-8045-8274-fb108396c20d" class="numbered-list" start="2"><li><code>c2</code>: sp¬≤ carbon (not used)</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="29a5d369-2a6a-80e4-af12-fae9c6f60a77" class="numbered-list" start="3"><li><code>c3</code>: sp¬≥ carbon (hydroxyl/epoxy modified)</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="29a5d369-2a6a-80ea-97ac-e1b0a6e8307d" class="numbered-list" start="4"><li><code>ca</code>: aromatic sp¬≤ carbon (unmodified graphene)</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="29a5d369-2a6a-8011-afb5-ff28f330406e" class="numbered-list" start="5"><li>‚Äî</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="29a5d369-2a6a-8077-a2e9-c33ec89464e8" class="numbered-list" start="6"><li><code>ho</code>: hydrogen bound to hydroxyl oxygen</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="29a5d369-2a6a-80b7-a0ed-e6004f457eb6" class="numbered-list" start="7"><li><code>oh</code>: hydroxyl oxygen</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="29a5d369-2a6a-8008-99d3-f9ac85032328" class="numbered-list" start="8"><li><code>os</code>: epoxy oxygen (bridging two sp¬≥ carbons)</li></ol></div><div style="display:contents" dir="auto"><p id="29a5d369-2a6a-80e5-957f-e587e5e7aa22" class=""><mark class="highlight-blue"><mark class="highlight-blue_background"><strong>Original GAFF.dat file:</strong></mark></mark></p></div><div style="display:contents" dir="ltr"><figure id="29a5d369-2a6a-8026-9ea8-f3f363e1ade0"><div class="source"><a href="gaff.dat">gaff.dat</a></div></figure></div><div style="display:contents" dir="auto"><p id="29a5d369-2a6a-803d-a714-e1d251f02d79" class=""><mark class="highlight-blue"><mark class="highlight-blue_background"><strong>GO FRCMOD file for GAFF created by Dr. Kim:</strong></mark></mark></p></div><div style="display:contents" dir="ltr"><figure id="2c35d369-2a6a-805b-97ab-e3ecf229228d"><div class="source"><a href="GO_gaff_Hoshin.frcmod">GO_gaff_Hoshin.frcmod</a></div></figure></div></div></div><div style="display:contents" dir="auto"><div id="29a5d369-2a6a-80a0-bdb2-e97b66b922b6" style="width:50%" class="column"><div style="display:contents" dir="auto"><h3 id="29a5d369-2a6a-805b-8452-e28d786250d3" class="">GAFF2</h3></div><div style="display:contents" dir="auto"><ol type="1" id="29a5d369-2a6a-802b-8ae9-ccacd0069162" class="numbered-list" start="1"><li> <code>c1</code>: sp carbon (edges)</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="29a5d369-2a6a-8016-ad55-cf06b97c8975" class="numbered-list" start="2"><li><code>c2</code>: sp¬≤ carbon (edges)</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="29a5d369-2a6a-80cc-a735-d8e0304b532b" class="numbered-list" start="3"><li><code>c3</code>: sp¬≥ carbon (hydroxyl)</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="29a5d369-2a6a-8035-a5e6-c8b7b8b4b233" class="numbered-list" start="4"><li><code>ca</code>: sp¬≤ carbon in aromatic systems (unmodified carbons not in edges)</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="29a5d369-2a6a-801b-9d27-e70b2c26984f" class="numbered-list" start="5"><li><code>cx</code>: sp¬≥ carbons in triangle systems (epoxy carbons)</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="29a5d369-2a6a-8071-82a4-fa0e6d9ca232" class="numbered-list" start="6"><li><code>ho</code>: hydrogen bound to oxygen</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="29a5d369-2a6a-80fe-bf7c-ed8173b3f280" class="numbered-list" start="7"><li><code>oh</code>: sp¬≥ oxygen in hydroxyl group</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="29a5d369-2a6a-8066-bf55-e324a2c17286" class="numbered-list" start="8"><li><code>op</code>: ether or ester oxygen in rings</li></ol></div><div style="display:contents" dir="auto"><p id="29a5d369-2a6a-8078-a57e-ff25edf98b5b" class=""><mark class="highlight-blue"><mark class="highlight-blue_background"><strong>Original GAFF2.dat file: </strong></mark></mark></p></div><div style="display:contents" dir="ltr"><figure id="29a5d369-2a6a-80cd-ad0e-cd0a5ea88d43"><div class="source"><a href="gaff2.dat">gaff2.dat</a></div></figure></div><div style="display:contents" dir="auto"><p id="29a5d369-2a6a-808f-8538-d3a3ac41312c" class=""><mark class="highlight-blue"><mark class="highlight-blue_background"><strong>GO FRCMOD file for GAFF2 created by Merve:</strong></mark></mark></p></div><div style="display:contents" dir="ltr"><figure id="29a5d369-2a6a-80af-aae1-d75d41eeea26"><div class="source"><a href="GO_gaff2_Merve.frcmod">GO_gaff2_Merve.frcmod</a></div></figure></div></div></div></div></div><div style="display:contents" dir="ltr"><figure id="29a5d369-2a6a-8094-bb2e-d46a1d0b60f2" class="image"><a href="Screenshot_from_2025-10-28_18-49-04.png"><img style="width:1119.984375px" src="Screenshot_from_2025-10-28_18-49-04.png"/></a></figure></div><div style="display:contents" dir="auto"><p id="2c35d369-2a6a-805a-85f3-f01d8da87780" class="">
</p></div><div style="display:contents" dir="auto"><p id="29a5d369-2a6a-80cc-8169-f2a621288cff" class="">
</p></div><div style="display:contents" dir="ltr"><figure id="29a5d369-2a6a-80c7-86db-f12e1f4b0c98" class="image"><a href="Screenshot_from_2025-10-28_18-45-22.png"><img style="width:1119.828125px" src="Screenshot_from_2025-10-28_18-45-22.png"/></a></figure></div><div style="display:contents" dir="auto"><p id="29a5d369-2a6a-802f-99a7-f0356c4a150f" class="">
</p></div></blockquote></div></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2995d369-2a6a-8087-b54b-daa94782c043" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked"><mark class="highlight-purple_background"><strong>Check the modified MOL2 file and finalize:</strong></mark><mark class="highlight-default"><mark class="highlight-default_background"><strong> </strong></mark></mark><mark class="highlight-default"><mark class="highlight-default_background">Reopen a fresh VMD and vis</mark></mark>ually confirm correctness of atom typing and connectivity before proceeding next steps. This cleaned and typed¬†<mark class="highlight-teal"><mark class="highlight-teal_background">.mol2</mark></mark>¬†file is now ready for force-field parameterization or charge derivation.</span><div class="indented"><div style="display:contents" dir="auto"><ul id="29a5d369-2a6a-80b9-b6fc-c00e35a9d65a" class="toggle"><li><details open=""><summary><strong>The MOL2 File</strong></summary><div style="display:contents" dir="ltr"><figure id="29a5d369-2a6a-8050-aac2-fc990d6a4244"><div class="source"><a href="4_GO_modified.mol2">4_GO_modified.mol2</a></div></figure></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="29a5d369-2a6a-80a2-8193-c81c5382f6ed" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all">@&lt;TRIPOS&gt;MOLECULE
generated by VMD
  343  467    1    0    0
SMALL
USER_CHARGES
****
Energy = 0

@&lt;TRIPOS&gt;ATOM
      1  C          1.8410    1.7750    0.0000   ca    1  GRA        0.000000
      2  C          0.6050    2.4840    0.0000   ca    1  GRA        0.000000
      3  C          0.6050    3.9080    0.0000   ca    1  GRA        0.000000
      4  C          1.8390    4.6200    0.0000   ca    1  GRA        0.000000
      5  C          4.3120    1.7750    0.0000   ca    1  GRA        0.000000
      6  C          3.0760    2.4840    0.0000   ca    1  GRA        0.000000
      7  C          3.0760    3.9080    0.0000   ca    1  GRA        0.000000
      8  C          4.3100    4.6200    0.0000   ca    1  GRA        0.000000
      9  C          6.7830    1.7750    0.0000   c3    3  EPX        0.160000
     10  C          5.5470    2.4840    0.0000   ca    1  GRA        0.000000
...
    340  H1        24.2780   17.0930   -2.5000   ho    2   OH        0.410000
    341  H1         4.1120   14.9400   -2.5000   ho    2   OH        0.410000
    342  H1        16.8670    5.7020   -2.5000   ho    2   OH        0.410000
    343  H1        23.8780   12.8200   -2.5000   ho    2   OH        0.410000
@&lt;TRIPOS&gt;BOND
    1     1     6  1
    2     1     2  1
    3     2     3  1
    4     3     4  1
...
  464   306   340  1
  465   307   341  1
  466   308   342  1
  467   309   343  1

@&lt;TRIPOS&gt;SUBSTRUCTURE
1 ****        1 TEMP                        0 ****  **** 0 ROOT</code></pre></div></details></li></ul></div></div></li></ul></div></div></details></div><div style="display:contents" dir="auto"><details open=""><summary style="font-weight:600;font-size:1.5em;line-height:1.3;margin:0">Step 5: Validate and Finalize the Modified GO Structure (mol2)</summary><div class="indented"><div style="display:contents" dir="auto"><p id="29a5d369-2a6a-8078-bbc4-ca3819cbf092" class="">After completing the atom-type assignment, several custom scripts can be run to extract structural data and confirm that the decorated graphene oxide sheet was generated correctly.</p></div><div style="display:contents" dir="auto"><ul id="29a5d369-2a6a-80c2-9346-e58907a11549" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked"><strong>Run </strong><mark class="highlight-blue"><mark class="highlight-blue_background"><strong> 2_atom_type_counter.tcl</strong></mark></mark> to check the distribution of GAFF atom types in your system. This script counts all atom types (e.g., <code>ca</code>, <code>c3</code>, <code>oh</code>, <code>os</code>, <code>ho</code>) and prints a concise summary in the VMD console. </span><div class="indented"><div style="display:contents" dir="auto"><ul id="29a5d369-2a6a-8037-add5-d4e1948cd21b" class="toggle"><li><details open=""><summary><strong>Script:</strong><mark class="highlight-blue"><mark class="highlight-blue_background"><strong> 2_atom_type_counter.tcl</strong></mark></mark></summary><div style="display:contents" dir="ltr"><figure id="29a5d369-2a6a-8055-8079-f4694166caaf"><div class="source"><a href="2_atom_type_counter.tcl">2_atom_type_counter.tcl</a></div></figure></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="29a5d369-2a6a-804a-85c4-dc37bf0d5fe5" class="code code-wrap"><code class="language-Bash" style="white-space:pre-wrap;word-break:break-all">source 2_atom_type_counter.tcl</code></pre></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="29a5d369-2a6a-8094-a872-e268c8eb5d57" class="code code-wrap"><code class="language-Bash" style="white-space:pre-wrap;word-break:break-all"># ------------------------------------------------------------------------------
# Title: Atom Type Counter Script for VMD
# ------------------------------------------------------------------------------
# Purpose:
# This script determines the number of atoms corresponding to specific atom types
# in a molecular structure loaded in VMD. The script uses atom selection 
# commands to filter atoms by their type and outputs the count for each 
# specified atom type.
#
# Usage:
# - Load this script in VMD after loading a molecular file (e.g., PDB or PSF).
# - Modify the list of atom types (`atom_types`) as per your requirements.
# - Run the script in the VMD Tcl console.
#
# Requirements:
# - VMD (Visual Molecular Dynamics) must be installed and the molecular file
#   should be loaded prior to running this script.
# - Atom types should be defined in the molecular file (e.g., via topology or
#   parameter files).
#
# Output:
# The script prints the count of atoms for each specified atom type to the 
# console.
#
# Author: Merve Fedai
# Date: 12/24/2024
# ------------------------------------------------------------------------------
# Define the atom types to count
# Modify this list to include the atom types relevant to your system
set atom_types [list &quot;ca&quot; &quot;c3&quot; &quot;oh&quot; &quot;os&quot; &quot;ho&quot;]

# Initialize a dictionary to store counts for each atom type
array set atom_counts {}

# Iterate over each atom type to count matching atoms
foreach atom_type $atom_types {
    # Select atoms matching the current atom type
    set sel [atomselect top &quot;type $atom_type&quot;]
    
    # Get the number of atoms in the selection
    set count [$sel num]
    
    # Store the count in the dictionary
    set atom_counts($atom_type) $count
    
    # Free the selection to release memory
    $sel delete
}

# Output the results
puts &quot;Atom Type Counts:&quot;
foreach atom_type $atom_types {
    puts &quot; - $atom_type: $atom_counts($atom_type)&quot;
}

# End of Script
# ------------------------------------------------------------------------------</code></pre></div></details></li></ul></div><div style="display:contents" dir="auto"><p id="29a5d369-2a6a-804a-9227-fb7983339523" class="">For example for this tutorial structure <mark class="highlight-teal"><mark class="highlight-teal_background">4_GO_modified.mol2</mark></mark> we get,</p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="29a5d369-2a6a-80e8-8c78-c74f56144db4" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">...
Atom Type Counts:
 - ca: 190
 - c3: 68
 - oh: 34
 - os: 17
 - ho: 34</code></pre></div><div style="display:contents" dir="auto"><blockquote id="29a5d369-2a6a-80b9-9839-f11be7f1a13e" class=""><strong>Note: </strong>Here <code>ca</code> shows all unmodified carbon atoms, <code>c3</code> shows all carbons that are modified with epoxy and hydroxyl including the onces in the edges, <code>oh</code> shows all hydroxyl oxygens, and <code>os</code> shows all epoxy oxygens, and <code>ho</code> shows hydroxyl hydrogens. Looking back to the original output from HierGO the results match so far.</blockquote></div></div></li></ul></div><div style="display:contents" dir="auto"><ul id="29a5d369-2a6a-8017-9e92-df54b3550272" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked"><strong>Run </strong><mark class="highlight-blue"><mark class="highlight-blue_background"><strong>3_C:O_ratio.tcl</strong></mark></mark> to calculate the carbon-to-oxygen (C:O) ratio and determine the actual oxidation level of the graphene oxide sheet. The script automatically identifies all <code>C</code> and <code>O1</code> atoms, counts them, and reports both totals along with the scaled ratio and oxidation percentage.</span><div class="indented"><div style="display:contents" dir="auto"><ul id="29a5d369-2a6a-80ea-bdb6-f1fbd582067d" class="toggle"><li><details open=""><summary><strong>Script:</strong><mark class="highlight-blue"><mark class="highlight-blue_background"><strong> 3_C:O_ratio.tcl</strong></mark></mark></summary><div style="display:contents" dir="ltr"><figure id="29a5d369-2a6a-8038-9ea2-fb5d2b55f526"><div class="source"><a href="3_CO_ratio.tcl">3_C:O_ratio.tcl</a></div></figure></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="29a5d369-2a6a-808c-9e93-e3fd7bd384c9" class="code code-wrap"><code class="language-Bash" style="white-space:pre-wrap;word-break:break-all">source 3_C:O_ratio.tcl</code></pre></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="29a5d369-2a6a-8027-ad48-dc168a318d5e" class="code code-wrap"><code class="language-Bash" style="white-space:pre-wrap;word-break:break-all"># ------------------------------------------------------------------------------
# Title: Graphene Oxide C:O Ratio and Oxidation Rate Calculator
# ------------------------------------------------------------------------------
# Purpose:
#   This script analyzes a graphene oxide (GO) structure in VMD to determine:
#       1) The total number of Carbon (C) and Oxygen (O/O1) atoms
#       2) The atomic C:O ratio (scaled to C:1)
#       3) The oxidation rate defined as (O/C) √ó 100
#
# Description:
#   This script validates the effective oxidation rate obtained from HierGO
#   functionalization by comparing the number of oxygen atoms added relative
#   to the total number of carbon atoms. It reports both the C:O ratio and
#   the percent oxygen content per carbon atom (%O/C), matching HierGO‚Äôs
#   internal convention for oxidation level.
#
# Usage:
#   1) Load your GO structure (.mol2) in VMD.
#   2) In the Tk Console, run:
#          source 3_C:O_ratio.tcl
#
# Notes:
#   - Oxidation rate = (N_O / N_C) √ó 100
#   - The result directly corresponds to HierGO‚Äôs ‚Äú--percento‚Äù target.
#   - Provides optional oxygen breakdown by residue (GRA, OH, EPX) to verify
#     that functionalization is spatially consistent.
#
# Author: Merve Fedai
# Date: 12/24/2024
# Last Update Date: 10/28/2025
# ------------------------------------------------------------------------------

# ----------------------------------------------------------------
# STEP 0: Pick the Current Molecule
# ----------------------------------------------------------------
if {[molinfo num] == 0} {
    puts &quot;No molecules loaded.&quot;
    return
}
set mol [molinfo top]

# ----------------------------------------------------------------
# STEP 1: Select Total Carbon Atoms
# ----------------------------------------------------------------
# Select all carbon atoms named &quot;C&quot;
set selC  [atomselect $mol &quot;name C&quot;]
set nC [$selC num]

# ----------------------------------------------------------------
# STEP 2: Select Total Oxygen Atoms (robust to naming)
# ----------------------------------------------------------------
# Prefer O1 (pipeline convention); fallback to element O
set selO1 [atomselect $mol &quot;name O1&quot;]
if {[$selO1 num] &gt; 0} {
    set selO $selO1
} else {
    set selO [atomselect $mol &quot;element O&quot;]
}
set nO [$selO num]

# ----------------------------------------------------------------
# STEP 3: Calculate C:O Ratio and Oxidation Percentage (O/C)
# ----------------------------------------------------------------
if {$nC == 0} {
    puts &quot;No carbon atoms found ‚Äî cannot compute oxidation ratio.&quot;
    $selC delete
    $selO delete
    return
}

# C:O ratio scaled to &#x27;C:1&#x27; (prints as C:O = X:1)
set ratioCO [expr {($nO &gt; 0) ? double($nC)/double($nO) : &quot;Inf&quot;}]

# Oxidation rate defined as atomic ratio of O/C √ó 100
set percO   [expr {100.0 * double($nO) / double($nC)}]

# ----------------------------------------------------------------
# STEP 4: Print Summary
# ----------------------------------------------------------------
puts &quot;Total Carbon atoms (C): $nC&quot;
puts &quot;Total Oxygen atoms (O): $nO&quot;
if {$nO &gt; 0} {
    puts [format &quot;C:O Ratio (scaled): %.4g:1&quot; $ratioCO]
} else {
    puts &quot;C:O Ratio (scaled): ‚àû:1 (no oxygens found)&quot;
}
puts [format &quot;Oxidation Rate (O/C √ó 100): %.3f%%&quot; $percO]

# ----------------------------------------------------------------
# STEP 5: Optional Oxygen Breakdown by Residue (GRA/OH/EPX)
# ----------------------------------------------------------------
# These only print if at least one atom matches; harmless otherwise.
set selO_OH  [atomselect $mol &quot;resname OH and (name O1 or element O)&quot;]
set selO_EPX [atomselect $mol &quot;resname EPX and (name O1 or element O)&quot;]
set nO_OH  [$selO_OH num]
set nO_EPX [$selO_EPX num]
if {$nO_OH &gt; 0 || $nO_EPX &gt; 0} {
    puts &quot;Oxygens by residue: OH=$nO_OH, EPX=$nO_EPX, Other=[expr {$nO - $nO_OH - $nO_EPX}]&quot;
}

# ----------------------------------------------------------------
# STEP 6: Cleanup
# ----------------------------------------------------------------
$selC delete
$selO delete
$selO_OH delete
$selO_EPX delete

# ----------------------------------------------------------------
# End of Script
# ----------------------------------------------------------------
</code></pre></div></details></li></ul></div><div style="display:contents" dir="auto"><p id="29a5d369-2a6a-807a-a973-c5d2218ae231" class="">For example for this tutorial structure <mark class="highlight-teal"><mark class="highlight-teal_background">4_GO_modified.mol2</mark></mark> we get,</p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="29a5d369-2a6a-807b-9fbb-eec9242fa105" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">...
Total Carbon atoms (C): 258
Total Oxygen atoms (O): 51
C:O Ratio (scaled): 5.059:1
Oxidation Rate (O/C √ó 100): 19.767%
Oxygens by residue: OH=34, EPX=17, Other=0</code></pre></div><div style="display:contents" dir="auto"><p id="29a5d369-2a6a-8012-9202-c6fe08f6b8db" class="">These results provide a quantitative check of the oxygen incorporation. For this system, the oxidation rate (19.8%) closely matches the target value of 20%, confirming that HierGO‚Äôs prediction is accurate. At higher oxidation levels, however, larger deviations can occur, especially when using the modified <mark class="highlight-blue"><mark class="highlight-blue_background"><strong>decorate-tile_modified.py</strong></mark></mark> script, which bypasses placement constraints. In those cases, the script may report artificially high oxidation levels (even up to 100%), but validation with this <mark class="highlight-blue"><mark class="highlight-blue_background"><strong>3_C:O_ratio.tcl</strong></mark></mark><strong> </strong>step typically reveals the actual achievable oxidation, which can be much lower (e.g., ~65%).</p></div></div></li></ul></div><div style="display:contents" dir="auto"><ul id="29a5d369-2a6a-8099-a95c-da28a6b207ac" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked"><strong>(Optional) Run </strong><mark class="highlight-blue"><mark class="highlight-blue_background"><strong>4_snapshot.tcl</strong></mark></mark><mark class="highlight-default_background"> </mark>for visual confirmation. This script generates a color-coded 3D view in VMD 1.9.4 where epoxy groups appear in <mark class="highlight-orange"><strong>orange</strong></mark>, hydroxyl groups in <mark class="highlight-purple"><strong>purple</strong></mark>, and unmodified carbons in <strong>black lines</strong>. It highlights complete, unmodified aromatic rings by filling <mark class="highlight-red"><strong>red</strong></mark><strong> </strong>into<strong> </strong>hexagons, allowing easy identification of hydrophobic patches. This visualization helps confirm both spatial distribution and surface heterogeneity of oxidation sites.</span><div class="indented"><div style="display:contents" dir="auto"><ul id="29a5d369-2a6a-8038-aad1-f04a3845a624" class="toggle"><li><details open=""><summary><strong>Script:</strong><mark class="highlight-blue"><mark class="highlight-blue_background"><strong> 4_snapshot.tcl</strong></mark></mark></summary><div style="display:contents" dir="ltr"><figure id="29a5d369-2a6a-80a6-82ac-c6209bbe3440"><div class="source"><a href="4_snapshot.tcl">4_snapshot.tcl</a></div></figure></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="29a5d369-2a6a-80b2-87f2-d910e3f3782a" class="code code-wrap"><code class="language-Bash" style="white-space:pre-wrap;word-break:break-all">source 4_snapshot.tcl</code></pre></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="29a5d369-2a6a-80f8-8e32-f875168872d1" class="code code-wrap"><code class="language-Bash" style="white-space:pre-wrap;word-break:break-all"># ------------------------------------------------------------------------------
# Title: VMD Display and Visualization Script for Graphene Oxide (GO)
# ------------------------------------------------------------------------------
# Purpose:
#   This script provides a standardized visual setup in VMD for graphene oxide
#   structures generated and processed through the HierGO workflow. It highlights
#   the spatial distribution of functional groups and hydrophobic regions by
#   applying distinct visual styles and colors to each residue type.
#
# Description:
#   The script configures the VMD display environment and assigns visual
#   representations for residues as follows:
#       - GRA (unmodified graphene regions): black licorice and paperchain view
#       - EPX (epoxy-modified carbons): orange
#       - OH  (hydroxyl-modified carbons): purple
#
#   In this visualization:
#       ‚Ä¢ Epoxy and hydroxyl groups are clearly distinguished by color.
#       ‚Ä¢ Unmodified carbons are shown as black frameworks.
#       ‚Ä¢ Fully unmodified rings are automatically outlined in red, visually
#         representing hydrophobic domains or pristine graphene patches.
#
# Usage:
#   1) Load your GO-modified structure in VMD.
#   2) Open the Tk Console and run:
#          source 4_snapshot.tcl
#   3) Adjust the view, zoom, or render settings as needed.
#
# Notes:
#   - This step is mainly for visualization and structural validation; it does
#     not modify coordinates.
#   - The color scheme helps confirm whether functional groups are uniformly
#     distributed or clustered.
#   - Hydrophobic patches appear as red-filled ring structures surrounded by
#     black outlines.
#
# Author: Merve Fedai
# Date: 12/24/2024
# Last Update Date: 10/28/2025
# ------------------------------------------------------------------------------

# ------------------------------------------------------------------------------
# Set Display Properties
# ------------------------------------------------------------------------------
display projection Orthographic
display rendermode GLSL
display shadows off
display ambientocclusion on
display aodirect 0.400000
color Display Background white
color Axes Labels black
axes location off
display depthcue off
scale by 1.200000

# ------------------------------------------------------------------------------
# Molecular Representation Setup
# ------------------------------------------------------------------------------

# Initial molecular representation
mol modstyle 0 0 Licorice 0.300000 82.000000 82.000000
mol modmaterial 0 0 AOChalky
mol modcolor 0 0 Chain

# Set chain color and adjust RGB for Chain X to gray
mol color Chain
color Chain X gray
color change rgb 2 gray 0.781095 0.781095 0.781095

# Update molecular representation
mol representation Licorice 0.300000 82.000000 82.000000
mol selection all
mol material AOChalky

# ------------------------------------------------------------------------------
# Add Representation for Specific Residues
# ------------------------------------------------------------------------------

# Add a new representation for selected residues
mol addrep 0
mol modselect 1 0 resname EPX OH
mol modstyle 1 0 CPK 2.000000 0.300000 82.000000 82.000000
mol modcolor 1 0 ResName
mol material AOChalky
# ------------------------------------------------------------------------------
# Representation for Residue GRA
# ------------------------------------------------------------------------------

# Licorice representation for GRA residues (overall structure)
mol addrep 0
mol modselect 2 0 resname GRA
mol modstyle 2 0 Licorice 0.500000 82.000000 82.000000
mol modcolor 2 0 ResName
mol material AOChalky
# PaperChain representation for GRA residues (highlighting specific feature)
mol representation PaperChain 1.000000 10.000000
mol selection resname GRA
mol material AOChalky
mol addrep 0
mol modstyle 3 0 PaperChain 1.000000 10.000000

# ------------------------------------------------------------------------------
# Set Colors for Specific Residues
# ------------------------------------------------------------------------------

color Resname EPX orange
color Resname OH purple
color Resname GRA black

# ------------------------------------------------------------------------------
# Render Settings and Final Output
# ------------------------------------------------------------------------------

#display rendermode Tachyon RTX RTRT
#render Tachyon /home/merve/Desktop/HierGO-master/Test/GO_all_percentages/GO5%/color_by_resname &quot;/usr/local/lib/vmd/tachyon_LINUXAMD64&quot; -aasamples 12 %s -format TARGA -res 3000 3000 -o %s.tga

</code></pre></div></details></li></ul></div><div style="display:contents" dir="auto"><p id="29a5d369-2a6a-8003-a217-d7a28dbc94ab" class="">For example for this tutorial structure <mark class="highlight-teal"><mark class="highlight-teal_background">4_GO_modified.mol2</mark></mark> we get,</p></div><div style="display:contents" dir="ltr"><figure id="29a5d369-2a6a-80be-acf2-f5690b7ca031" class="image"><a href="c88c8e92-1dd9-465e-a67f-cf638c731a63.png"><img style="width:864px" src="c88c8e92-1dd9-465e-a67f-cf638c731a63.png"/></a><figcaption>Figure 8. Detailed visualization of the graphene oxide after 4_snapshot.tcl</figcaption></figure></div><div style="display:contents" dir="auto"><p id="29a5d369-2a6a-8065-9af1-d56fea323612" class="">This allows for visual check verification for the oxidation script produced the expected balance of aromatic, hydroxyl, and epoxy atoms. For example check this note below</p></div><div style="display:contents" dir="auto"><blockquote id="29a5d369-2a6a-8051-bc00-e9a324f7298f" class=""><strong>Note: </strong>The oxidation rate can be directly estimated from the C:O ratio using the following relationship: <style>@import url('https://cdn.jsdelivr.net/npm/katex@0.16.25/dist/katex-swap.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mi>x</mi><mi>i</mi><mi>d</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi><mi>R</mi><mi>a</mi><mi>t</mi><mi>e</mi><mo>=</mo><mo stretchy="false">[</mo><msub><mi>N</mi><mi>O</mi></msub><mi mathvariant="normal">/</mi><msub><mi>N</mi><mi>C</mi></msub><mo stretchy="false">]</mo><mo>√ó</mo><mn>100</mn></mrow><annotation encoding="application/x-tex">Oxidation Rate=[N_O/N_C]√ó100</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mord mathnormal">x</span><span class="mord mathnormal">i</span><span class="mord mathnormal">d</span><span class="mord mathnormal">a</span><span class="mord mathnormal">t</span><span class="mord mathnormal">i</span><span class="mord mathnormal">o</span><span class="mord mathnormal">n</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord mathnormal">a</span><span class="mord mathnormal">t</span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">O</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">/</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">√ó</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">100</span></span></span></span></span><span>Ôªø</span></span><div style="display:contents" dir="auto"><p id="29a5d369-2a6a-8023-ba5e-ffd33c6b94fb" class="">where <style>@import url('https://cdn.jsdelivr.net/npm/katex@0.16.25/dist/katex-swap.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>N</mi><mi>O</mi></msub></mrow><annotation encoding="application/x-tex">N_O</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">O</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>Ôªø</span></span> is the number of oxygen atoms and <style>@import url('https://cdn.jsdelivr.net/npm/katex@0.16.25/dist/katex-swap.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>N</mi><mi>C</mi></msub></mrow><annotation encoding="application/x-tex">N_C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>Ôªø</span></span> is the number of carbon atoms. </p></div><div style="display:contents" dir="auto"><p id="29a5d369-2a6a-80ef-a6aa-f7b2f1f148ed" class="">Using your data from the <mark class="highlight-blue"><mark class="highlight-blue_background"><strong>3_C:O_ratio.tcl</strong></mark></mark><mark class="highlight-default_background"> </mark>output we got 258 Carbon atoms and 51 oxygen atoms, this results in 16.5% oxidation rate. So, even though the HierGO input was set to <strong>20%</strong>, the actual oxidation level calculated from the final structure is <strong>‚âà16.5%</strong>. This discrepancy reflects what you already discussed earlier in the tutorial at higher or even moderate oxidation levels, the script may fail to add all requested oxygen atoms due to limited available sites.</p></div></blockquote></div><div style="display:contents" dir="auto"><p id="29a5d369-2a6a-8017-95cd-c78339a1cdc6" class="">
</p></div></div></li></ul></div><div style="display:contents" dir="auto"><ul id="29a5d369-2a6a-806b-8465-e8aa2af6f774" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked"><strong>Run </strong><mark class="highlight-blue"><mark class="highlight-blue_background"><strong>5_mol2_substruct_numpy.py</strong></mark></mark> This is written by Dr. James Peerless (alumnus in Yingling Group). This Python script rebuilds the SUBSTRUCTURE section of the <mark class="highlight-teal"><mark class="highlight-teal_background">.mol2</mark></mark> file, ensuring that all residue and connectivity information is correctly formatted for downstream use in AMBER. It renumbers residues sequentially, updates the molecular header, and produces a clean output file that can be directly used for parameterization.</span><div class="indented"><div style="display:contents" dir="auto"><ul id="29a5d369-2a6a-805d-9a56-cad4c89d8136" class="toggle"><li><details open=""><summary><strong>Script:</strong><mark class="highlight-blue"><mark class="highlight-blue_background"><strong> 5_mol2_substruct_numpy.py</strong></mark></mark></summary><div style="display:contents" dir="ltr"><figure id="29a5d369-2a6a-80fa-bfaa-efa0977f414e"><div class="source"><a href="5_mol2_substruct_numpy.py">5_mol2_substruct_numpy.py</a></div></figure></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="29a5d369-2a6a-80e0-89b0-d5bc408286cb" class="code code-wrap"><code class="language-Bash" style="white-space:pre-wrap;word-break:break-all"># In the terminal
./5_mol2_substruct_numpy.py -i 4_GO_modified.mol2 -o 5_GO20_modified_final.mol2

# If that doesnt work use
python3 5_mol2_substruct_numpy.py -i 4_GO_modified.mol2 -o 5_GO20_modified_final.mol2</code></pre></div><div style="display:contents" dir="auto"><p id="29b5d369-2a6a-8039-b233-dc9674f7a861" class="">You can also add &quot;python3&quot; to the beginning of the script if this doesn&#x27;t work.</p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="29a5d369-2a6a-8091-946a-ecc546f4b539" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all">#!/usr/bin/python
&#x27;&#x27;&#x27;
Mol2 Substrucuture Builder - mol2_substruct.py
    
	Author: James Peerless
			Yingling Group
			NC State University

	Date Created:	Mar 05, 2017

	Date Modified:	Apr 10, 2017

	Purpose:	Rebuild the SUBSTRUCTURE section of a Tripos Mol2 format
				molecular structure file. Requires that residue info is still
				contained in ATOM section.
    
	Usage:		mol2_substruct.py [-h] -i input [-o output]
	
				input:	string with Mol2 filename with missing substructure
						info.
				
				output:	string for output filename. (Optional - default = 
						&#x27;substruct_out.mol2&#x27;)

	Notes/Bugs: Resid&#x27;s renumbered so that they are sequential (no skipping).
				This is necessary for tLeap, but will change resid&#x27;s.
				
				Atom section is no longer fixed-width. (Does not affect AMBER
				or VMD, but may affect others.)
				
				NOT SPEED OPTIMIZED - iterators used a lot. Bench mark is
				1-2 seconds for 130,000 atoms.
&#x27;&#x27;&#x27;
##############################################################################
#        Initialization                                                      #
##############################################################################

# Import necessary packages
import time
import argparse
import numpy as np

# Start the clock
t_start = time.time()
update = 1

# Inputs
parser = argparse.ArgumentParser(description=&#x27;This script repopulates missing&#x27;\
								&#x27; SUBSTRUCTURE sections of Mol2 format &#x27;\
								&#x27; structure files. \nWritten by James Peerless&#x27;)
parser.add_argument(&#x27;-i&#x27;,&#x27;--input&#x27;,help=&#x27;Input Mol2 file&#x27;,required=True)
parser.add_argument(&#x27;-o&#x27;,&#x27;--output&#x27;,default=&#x27;substruct_out.mol2&#x27;, \
					help=&#x27;Output Mol2 file name (default = &#x27;\
					&#x27;substruct_out.mol2&#x27;,required=False)
args = parser.parse_args()

# DEBUG ONLY
#args.input = &#x27;HA_stripped.mol2&#x27;
#args.output = &#x27;substruct_out.mol2&#x27;

ifname = str(args.input)
ofname = str(args.output)

##############################################################################
#        Get Mol Info                                                        #
##############################################################################
mol_hln = -9999

print(&#x27;Reading&#x27;, ifname, &#x27;...&#x27;)

# Save all line info from original file
with open(ifname) as infile:
	lines = infile.readlines()

# Extract header positions and number of atoms
for line in lines:
	if &#x27;@&lt;TRIPOS&gt;MOLECULE&#x27; in line:
		mol_hln = lines.index(line)
	if lines.index(line) == (mol_hln+2):
		num_atms = int(line.split()[0])
	if &#x27;@&lt;TRIPOS&gt;ATOM&#x27; in line:
		atm_hln = lines.index(line)
		break

##############################################################################
#        Output data into outfile											 #
##############################################################################
# Remove last line
lines = lines[:-1]
# Correct residue numbers so that they are sequential (also split atom lines
#	to use in condtructing SUBSTRUCTURE section
old_res_num = 0
n = 0
split_atm_lines = []
for line_n in range(atm_hln+1,(atm_hln+num_atms+1)):
	atm_line = lines[line_n].split()
	res_num = int(atm_line[6])
	if res_num != old_res_num:
		n = n + 1
		old_res_num = res_num
	atm_line[6] = str(n)
	split_atm_lines.append(atm_line)
	atm_line.append(&#x27;\n&#x27;)
	lines[line_n] = &#x27;  &#x27;.join(atm_line)
# Set info line w/correct n_res
n_res = n
mol_info_ln = lines[mol_hln+2].split()
lines[mol_hln+2] = mol_info_ln[0]+&#x27; &#x27;+mol_info_ln[1]+&#x27; &#x27;+str(n_res)\
					+&#x27;     0     0 \n&#x27;

# Construct array from ATOM section
atoms         = np.asarray(split_atm_lines)
atoms_subinfo = atoms[:, (0,6,7)]

# Construct SUBSTRUCTURE array
nres          = np.shape(np.unique(atoms_subinfo[:,1]))[0]
subinfo_resid = []
junk_tail     = np.reshape(np.asarray(np.repeat(&#x27;****               0 ****  ****&#x27;, nres)), (nres,1))

for i in range(1, nres + 1):
	subinfo_resid.append(np.where(atoms_subinfo[:,1] == str(i))[0][0])

subinfo   = atoms[subinfo_resid,:]
subinfo   = subinfo[:, (6,7,0)]
subinfo   = np.hstack((subinfo, junk_tail))

# Convert to list and change resid&#x27;s and atom id&#x27;s to fixed-width strings
subinfo_list = subinfo.tolist()
for i in subinfo_list:
	i[0] = &#x27;{0:&gt;7}&#x27;.format(str(i[0]))
	i[2] = &#x27;{0:&gt;13}&#x27;.format(str(i[2]))

# Append new SUBSTRUCTURE section to &quot;lines&quot;
for subinfo_line in subinfo_list:
	lines.append(&#x27; &#x27;.join(subinfo_line)+&#x27;\n&#x27;)

# Print out all lines from header, modified ATOM stection
print(&#x27;Writing&#x27;, ofname, &#x27;...&#x27;)
with open(ofname, &#x27;w&#x27;) as outfile:
	outfile.write(&#x27;&#x27;.join(lines))				

##############################################################################
#        Denoument                                                           #
##############################################################################
total_time = time.time() - t_start
print(&#x27;Success!&#x27;)
print(&#x27;Excecution time: %.2f min for %i atoms&#x27; % (total_time/60, num_atms))</code></pre></div><div style="display:contents" dir="auto"><p id="29a5d369-2a6a-8094-9de0-cdcbad353db7" class=""><strong>Example output:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="29a5d369-2a6a-808c-a42b-f14e880d40cd" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all">./5_mol2_substruct_numpy.py -i 4_GO_modified.mol2 -o 5_GO20_modified_final.mol2
Reading 4_GO_modified.mol2 ...
Writing 5_GO20_modified_final.mol2 ...
Success!
Excecution time: 0.00 min for 343 atoms</code></pre></div></details></li></ul></div><div style="display:contents" dir="auto"><ul id="29a5d369-2a6a-80bf-afa4-fef61a188080" class="toggle"><li><details open=""><summary><strong>The finalized MOL2 file</strong></summary><div style="display:contents" dir="ltr"><figure id="29a5d369-2a6a-806f-a867-f96b5fbb1788"><div class="source"><a href="5_GO20_modified_final.mol2">5_GO20_modified_final.mol2</a></div></figure></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="29a5d369-2a6a-80d0-9dff-dd65ad191344" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all">@&lt;TRIPOS&gt;MOLECULE
generated by VMD
343 467 110     0     0 
SMALL
USER_CHARGES
****
Energy = 0

@&lt;TRIPOS&gt;ATOM
1  C  1.8410  1.7750  0.0000  ca  1  GRA  0.000000  
2  C  0.6050  2.4840  0.0000  ca  1  GRA  0.000000  
3  C  0.6050  3.9080  0.0000  ca  1  GRA  0.000000  
4  C  1.8390  4.6200  0.0000  ca  1  GRA  0.000000  
5  C  4.3120  1.7750  0.0000  ca  1  GRA  0.000000  
6  C  3.0760  2.4840  0.0000  ca  1  GRA  0.000000  
7  C  3.0760  3.9080  0.0000  ca  1  GRA  0.000000  
8  C  4.3100  4.6200  0.0000  ca  1  GRA  0.000000  
9  C  6.7830  1.7750  0.0000  c3  2  EPX  0.160000
...
342  H1  16.8670  5.7020  -2.5000  ho  110  OH  0.410000  
343  H1  23.8780  12.8200  -2.5000  ho  110  OH  0.410000  
@&lt;TRIPOS&gt;BOND
    1     1     6  1
    2     1     2  1
    3     2     3  1
    ...
  465   307   341  1
  466   308   342  1
  467   309   343  1
  
...
@&lt;TRIPOS&gt;SUBSTRUCTURE
      1 GRA             1 ****               0 ****  ****
      2 EPX             9 ****               0 ****  ****
      ...
    107 GRA           258 ****               0 ****  ****
    108 OH           259 ****               0 ****  ****
    109 EPX           283 ****               0 ****  ****
    110 OH           300 ****               0 ****  ****
</code></pre></div></details></li></ul></div><div style="display:contents" dir="auto"><blockquote id="29a5d369-2a6a-80d1-984a-ccda883c3a5c" class=""><strong>Note: </strong>This file is now ready for the simulation setup take the <mark class="highlight-blue"><mark class="highlight-blue_background"><strong>GO_gaff_Hoshin.frcmod</strong></mark></mark> One thing to note is that if the file is reopened in DS Visualizer, it will not recognize the correct atoms due to changes in the atom type definitions.</blockquote></div></div></li></ul></div></div></details></div><div style="display:contents" dir="auto"><p id="2c25d369-2a6a-80a0-a886-e95c9553fe4f" class=""><strong>Note (Optional): </strong>This model is currently sufficient for running simulations involving surfaces in aqueous solutions or water droplet systems. However, if these surfaces are to be used in conjunction with other biomolecules, such as enzymes, the atom names and residue names will need to be modified, and the entire surface should be assigned a single residue ID.</p></div><div style="display:contents" dir="auto"><p id="2c25d369-2a6a-8060-9df5-dd1ad1f5eaa8" class="">Graphene oxide sheets can be misidentified as protein in VMD and AMBER/LEaP due to their atom and residue naming conventions. For example in VMD, a residue is classified as <em>protein</em> if it contains atoms named <strong>C, N, CA, and O</strong>, so GO atoms labeled simply <strong>C</strong> or <strong>O</strong> may trigger incorrect protein selection. Similarly, fragmented or inconsistent GO residue definitions can cause LEaP warnings, residue merging, and connect0/connect1 failures when proteins are present. To prevent these issues, the entire sheet is reassigned to a single residue (<code>GRO</code>) with a unified residue ID, and atom names are normalized (C‚ÜíC1, O‚ÜíO1, H‚ÜíH1). This ensures clean topology generation and avoids misclassification in both VMD and LEaP.</p></div><div style="display:contents" dir="auto"><p id="2c25d369-2a6a-80ef-9866-e4893b67fdc1" class="">To fix this possible issue, one can load the final .mol2 structure and reassign the atom names, residue names and residue ids as shown below.</p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2c25d369-2a6a-803e-a9cf-fabe817ea4db" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all"># Use this when GO MOL2 residue definitions are corrupted and cause LEaP errors.
# This ensures the entire graphene or graphene oxide sheet is treated cleanly 
# as one residue (GRO), avoiding:
#   - &quot;unusual bond between residues&quot; warnings,
#   - LEaP residue merging,
#   - connect0/connect1 assignment failures.
# Note: this was added later for systems with a protein due to issues
# encountered with the misidentification of resname GRA, OH, and EPX as part of protein.

# Graphene oxide (GRA, OH, EPX)
set surface [atomselect 0 &quot;resname GRA OH EPX&quot;]

# Apply only to the surface (Molecule ID 0)
$surface set resid 1
$surface set resname GRO

# Normalize atom naming to keep consistency
set carbons [atomselect 0 &quot;name C or name C1&quot;]
$carbons set name C1
$carbons delete

# Normalize atom naming to keep consistency
set oxygens [atomselect 0 &quot;name O or name O1&quot;]
$oxygens set name O1
$oxygens delete

set hydrogens [atomselect 0 &quot;name H or name H1&quot;]
$hydrogens set name H1
$hydrogens delete

$surface update
$surface writemol2 6_SurfaceCombinedGRO.mol2</code></pre></div><div style="display:contents" dir="auto"><p id="2c25d369-2a6a-8025-8626-f471698ff6f2" class="">
</p></div></div></article><span class="sans" style="font-size:14px;padding-top:2em"></span></body></html>